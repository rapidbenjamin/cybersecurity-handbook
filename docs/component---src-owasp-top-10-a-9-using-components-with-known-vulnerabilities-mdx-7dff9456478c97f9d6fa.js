(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{DvAn:function(e,t,n){e.exports=n.p+"static/prototype_pollution_alert-3f2928683e87e6720babbc40fd3b1fce.png"},Euuz:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return r})),n.d(t,"default",(function(){return c}));n("5hJT"),n("W1QL"),n("K/PF"),n("t91x"),n("75LO"),n("PJhk"),n("mXGw");var i=n("/FXl"),a=n("TjRS");n("aD51");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}var r={};void 0!==r&&r&&r===Object(r)&&Object.isExtensible(r)&&!r.hasOwnProperty("__filemeta")&&Object.defineProperty(r,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/owasp_top_10/a9_using_components_with_known_vulnerabilities.mdx"}});var s={_frontmatter:r},l=a.a;function c(e){var t=e.components,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["components"]);return Object(i.b)(l,o({},s,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"a9-using-components-with-known-vulnerabilities"},"A9 Using Components with Known Vulnerabilities"),Object(i.b)("h2",{id:"definition"},"Definition"),Object(i.b)("p",null,"Components, such as libraries, frameworks, and other software modules, run with the same\nprivileges as the application. If a vulnerable component is exploited, such an attack can facilitate\nserious data loss or server takeover. Applications and APIs using components with known\nvulnerabilities may undermine application defenses and enable various attacks and impacts. "),Object(i.b)("h2",{id:"risk-factor-summary"},"Risk Factor Summary"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Score: 4.7"),Object(i.b)("li",{parentName:"ul"},"Attack Vectors Exploitability: 2"),Object(i.b)("li",{parentName:"ul"},"Security Weakness Prevalence: 3"),Object(i.b)("li",{parentName:"ul"},"Security Weakness Detectability: 2"),Object(i.b)("li",{parentName:"ul"},"Impact Technical: 2")),Object(i.b)("h2",{id:"context"},"Context"),Object(i.b)("iframe",{width:"100%",height:"450",src:"https://www.youtube.com/embed/IGsNYVDKRV0"}),Object(i.b)("p",null,"While it is easy to find already-written\nexploits for many known\nvulnerabilities, other vulnerabilities\nrequire concentrated effort to develop\na custom exploit."),Object(i.b)("p",null,"Prevalence of this issue is very widespread.\nComponent-heavy development patterns can lead to\ndevelopment teams not even understanding which\ncomponents they use in their application or API,\nmuch less keeping them up to date."),Object(i.b)("p",null,"Some scanners such as retire.js help in detection,\nbut determining exploitability requires additional\neffort."),Object(i.b)("p",null,"While some known vulnerabilities\nlead to only minor impacts, some of\nthe largest breaches to date have\nrelied on exploiting known\nvulnerabilities in components.\nDepending on the assets you are\nprotecting, perhaps this risk should\nbe at the top of the list."),Object(i.b)("h2",{id:"is-the-application-vulnerable"},"Is the Application Vulnerable?"),Object(i.b)("p",null,"You are likely vulnerable:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"If you do not know the versions of all components you use\n(both client-side and server-side). This includes components\nyou directly use as well as nested dependencies."),Object(i.b)("li",{parentName:"ul"},"If software is vulnerable, unsupported, or out of date. This\nincludes the OS, web/application server, database\nmanagement system (DBMS), applications, APIs and all\ncomponents, runtime environments, and libraries."),Object(i.b)("li",{parentName:"ul"},"If you do not scan for vulnerabilities regularly and subscribe to\nsecurity bulletins related to the components you use."),Object(i.b)("li",{parentName:"ul"},"If you do not fix or upgrade the underlying platform,\nframeworks, and dependencies in a risk-based, timely fashion.\nThis commonly happens in environments when patching is a\nmonthly or quarterly task under change control, which leaves\norganizations open to many days or months of unnecessary\nexposure to fixed vulnerabilities."),Object(i.b)("li",{parentName:"ul"},"If software developers do not test the compatibility of updated,\nupgraded, or patched libraries."),Object(i.b)("li",{parentName:"ul"},"If you do not secure the components' configurations\n(see ",Object(i.b)("a",o({parentName:"li"},{href:"/cybersecurity-handbook/owasp/a6_security_misconfiguration"}),"A6:2017-Security Misconfiguration"),").")),Object(i.b)("h2",{id:"conceptual-attacks"},"Conceptual Attacks"),Object(i.b)("h3",{id:"scenario-1"},"Scenario #1:"),Object(i.b)("p",null,"Components typically run with the same privileges\nas the application itself, so flaws in any component can result in\nserious impact. Such flaws can be accidental (e.g. coding error)\nor intentional (e.g. backdoor in component). Some example\nexploitable component vulnerabilities discovered are:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",o({parentName:"li"},{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638"}),"CVE-2017-5638"),", a Struts 2 remote code execution vulnerability\nthat enables execution of arbitrary code on the server, has\nbeen blamed for significant breaches."),Object(i.b)("li",{parentName:"ul"},"While ",Object(i.b)("a",o({parentName:"li"},{href:"https://en.wikipedia.org/wiki/Internet_of_things"}),"internet of things (IoT)")," are frequently difficult or\nimpossible to patch, the importance of patching them can be\ngreat (e.g. biomedical devices).\nThere are automated tools to help attackers find unpatched or\nmisconfigured systems. For example, the Shodan IoT search\nengine can help you ",Object(i.b)("a",o({parentName:"li"},{href:"https://www.shodan.io/report/89bnfUyJ"}),"find devices")," that still suffer from\nthe ",Object(i.b)("a",o({parentName:"li"},{href:"https://en.wikipedia.org/wiki/Heartbleed"}),"Heartbleed vulnerability")," that was patched in April 2014.")),Object(i.b)("h2",{id:"example-attack-scenarios"},"Example Attack Scenarios"),Object(i.b)("h3",{id:"prototype-pollution-attack"},"Prototype pollution attack:"),Object(i.b)("p",null,Object(i.b)("img",{alt:"screenshoot from npm audit at Github Netflix/nerror",src:n("DvAn")}),"\n",Object(i.b)("em",{parentName:"p"},"Image from ",Object(i.b)("a",o({parentName:"em"},{href:"https://github.com/Netflix/nerror/issues/8"}),"Github Netflix/nerror"))),Object(i.b)("p",null,"In order to get a full picture of this attack check ",Object(i.b)("a",o({parentName:"p"},{href:"/cybersecurity-handbook/attacks_explained/prototype_pollution"}),"Explained attacks: Prototype Pollution in this guide")),Object(i.b)("h3",{id:"lockfile-poison"},"lockfile poison"),Object(i.b)("p",null,"In order to get a full picture of this attack check ",Object(i.b)("a",o({parentName:"p"},{href:"/cybersecurity-handbook/attacks_explained/lockfile"}),"Explained attacks: Prototype Pollution in this guide")),Object(i.b)("h2",{id:"how-to-prevent"},"How to Prevent"),Object(i.b)("p",null,"There should be a patch management process in place to:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Check the dependencies tree. ",Object(i.b)("inlineCode",{parentName:"li"},"npm ls")),Object(i.b)("li",{parentName:"ul"},"Check for outdated dependencies. ",Object(i.b)("inlineCode",{parentName:"li"},"npm outdated")),Object(i.b)("li",{parentName:"ul"},"Remove unused dependencies, unnecessary features,\ncomponents, files, and documentation. ",Object(i.b)("inlineCode",{parentName:"li"},"npx depcheck")),Object(i.b)("li",{parentName:"ul"},"Continuously inventory the versions of both client-side and\nserver-side components (e.g. frameworks, libraries) and their\ndependencies using tools like ",Object(i.b)("a",o({parentName:"li"},{href:"https://support.snyk.io/hc/en-us/articles/360003919937-Getting-started-with-the-CLI"}),"Snyk"),". "),Object(i.b)("li",{parentName:"ul"},"Continuously monitor sources like ",Object(i.b)("a",o({parentName:"li"},{href:"https://cve.mitre.org/"}),"CVE")," and ",Object(i.b)("a",o({parentName:"li"},{href:"https://nvd.nist.gov/"}),"NVD"),"\nfor vulnerabilities in the components and subscribe to email\nalerts for security vulnerabilities related to components you\nuse.. "),Object(i.b)("li",{parentName:"ul"},"Use software composition\nanalysis tools to automate the process or CI process to review your dependencies. "),Object(i.b)("li",{parentName:"ul"},"Only obtain components from official sources (NPM, Github, Docker Hub...) over secure links.\nPrefer signed packages to reduce the chance of including a\nmodified, malicious component."),Object(i.b)("li",{parentName:"ul"},"Monitor for libraries and components that are unmaintained or\ndo not create security patches for older versions. "),Object(i.b)("li",{parentName:"ul"},"Every organization must ensure that there is an ongoing plan for\nmonitoring, triaging, and applying updates or configuration\nchanges for the lifetime of the application or portfolio. "),Object(i.b)("li",{parentName:"ul"},"Define security policies about which components are allowed to be used in the organization"),Object(i.b)("li",{parentName:"ul"},"Use multi stage docker in order to use the minimum base possible like alpine once the image is built.")),Object(i.b)("h4",{id:"please-review"},"Please review"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"The ",Object(i.b)("a",o({parentName:"li"},{href:"/cybersecurity-handbook/best_practices/npm_and_dependencies"}),"Best practices for Npm and dependencies in this guide")),Object(i.b)("li",{parentName:"ul"},"The ",Object(i.b)("a",o({parentName:"li"},{href:"/cybersecurity-handbook/best_practices/docker"}),"Best practices for Docker in this guide"))),Object(i.b)("h2",{id:"hacking-playground"},"Hacking Playground"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",o({parentName:"li"},{href:"https://nodegoat.herokuapp.com/tutorial/a9"}),"🐐 NodeGoat | A9 Using Components with Known Vulnerabilities")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",o({parentName:"li"},{href:"https://pwning.owasp-juice.shop/part2/vulnerable-components.html"}),"🧃 Pwning OWASP Juice Shop | A9 Using Components with Known Vulnerabilities"))),Object(i.b)("h2",{id:"references"},"References"))}void 0!==c&&c&&c===Object(c)&&Object.isExtensible(c)&&!c.hasOwnProperty("__filemeta")&&Object.defineProperty(c,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/owasp_top_10/a9_using_components_with_known_vulnerabilities.mdx"}}),c.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-owasp-top-10-a-9-using-components-with-known-vulnerabilities-mdx-7dff9456478c97f9d6fa.js.map