(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{"W/LO":function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return s})),a.d(t,"default",(function(){return l}));a("5hJT"),a("W1QL"),a("K/PF"),a("t91x"),a("75LO"),a("PJhk"),a("mXGw");var r=a("/FXl"),n=a("TjRS");a("aD51");function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var s={};void 0!==s&&s&&s===Object(s)&&Object.isExtensible(s)&&!s.hasOwnProperty("__filemeta")&&Object.defineProperty(s,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/owasp_top_10/a3_sensitive_data_exposure.mdx"}});var o={_frontmatter:s},c=n.a;function l(e){var t=e.components,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,["components"]);return Object(r.b)(c,i({},o,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"a3-sensitive-data-exposure"},"A3 Sensitive Data Exposure"),Object(r.b)("p",null,Object(r.b)("img",{alt:"CommitStrip | Security checklist",src:a("j1of")}),"\n",Object(r.b)("em",{parentName:"p"},"Image from ",Object(r.b)("a",i({parentName:"em"},{href:"http://www.commitstrip.com/en/2014/10/28/security-checklist/"}),"CommitStrip | Security checklist"))),Object(r.b)("h2",{id:"definition"},"Definition"),Object(r.b)("p",null,"Many web applications and APIs do not properly protect sensitive data, such as financial,\nhealthcare, and PII. Attackers may steal or modify such weakly protected data to conduct credit\ncard fraud, identity theft, or other crimes. Sensitive data may be compromised without extra\nprotection, such as encryption at rest or in transit, and requires special precautions when\nexchanged with the browser."),Object(r.b)("h2",{id:"risk-factor-summary"},"Risk Factor Summary"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Score: 7.0"),Object(r.b)("li",{parentName:"ul"},"Attack Vectors Exploitability: 2"),Object(r.b)("li",{parentName:"ul"},"Security Weakness Prevalence: 3"),Object(r.b)("li",{parentName:"ul"},"Security Weakness Detectability: 2"),Object(r.b)("li",{parentName:"ul"},"Impact Technical: 3")),Object(r.b)("h2",{id:"context"},"Context"),Object(r.b)("iframe",{width:"100%",height:"450",src:"https://www.youtube.com/embed/2RKbacrkUBU"}),Object(r.b)("p",null,"Rather than directly attacking crypto,\nattackers steal keys, execute man-inthe-middle attacks, or steal clear text\ndata off the server, while in transit, or\nfrom the user‚Äôs client, e.g. browser. A\nmanual attack is generally required.\nPreviously retrieved password\ndatabases could be brute forced by\nGraphics Processing Units (GPUs)."),Object(r.b)("p",null,"Over the last few years, this has been the most\ncommon impactful attack. The most common flaw is\nsimply not encrypting sensitive data. When crypto is\nemployed, weak key generation and management,\nand weak algorithm, protocol and cipher usage is\ncommon, particularly for weak password hashing\nstorage techniques. For data in transit, server side\nweaknesses are mainly easy to detect, but hard for\ndata at rest. "),Object(r.b)("p",null,"Failure frequently compromises all\ndata that should have been protected.\nTypically, this information includes\nsensitive personal information (PII)\ndata such as health records, credentials, personal data, and credit cards,\nwhich often require protection as\ndefined by laws or regulations such as\nthe EU GDPR or local privacy laws."),Object(r.b)("h2",{id:"is-the-application-vulnerable"},"Is the Application Vulnerable?"),Object(r.b)("p",null,"The first thing is to determine the protection needs of data in\ntransit and at rest. For example, passwords, credit card numbers,\nhealth records, personal information and business secrets\nrequire extra protection, particularly if that data falls under\nprivacy laws, e.g. EU's General Data Protection Regulation\n(GDPR), or regulations, e.g. financial data protection such as\nPCI Data Security Standard (PCI DSS). For all such data:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Is any data transmitted in clear text? This concerns protocols\nsuch as HTTP, SMTP, and FTP. External internet traffic is\nespecially dangerous. Verify all internal traffic e.g. between\nload balancers, web servers, or back-end systems."),Object(r.b)("li",{parentName:"ul"},"Is sensitive data stored in clear text, including backups?"),Object(r.b)("li",{parentName:"ul"},"Are any old or weak cryptographic algorithms used either by\ndefault or in older code?"),Object(r.b)("li",{parentName:"ul"},"Are default crypto keys in use, weak crypto keys generated or\nre-used, or is proper key management or rotation missing?"),Object(r.b)("li",{parentName:"ul"},"Is encryption not enforced, e.g. are any user agent (browser)\nsecurity directives or headers missing?"),Object(r.b)("li",{parentName:"ul"},"Does the user agent (e.g. app, mail client) not verify if the\nreceived server certificate is valid?")),Object(r.b)("h2",{id:"conceptual-attacks"},"Conceptual Attacks"),Object(r.b)("p",null,Object(r.b)("img",{alt:"meme - you can't leak passwords if you don't store them",src:a("hxik")})),Object(r.b)("h3",{id:"scenario-1"},"Scenario #1:"),Object(r.b)("p",null,"An application encrypts credit card numbers in a\ndatabase using automatic database encryption. However, this\ndata is automatically decrypted when retrieved, allowing an SQL\ninjection flaw to retrieve credit card numbers in clear text."),Object(r.b)("h3",{id:"scenario-2"},"Scenario #2:"),Object(r.b)("p",null,"A site doesn't use or enforce TLS for all pages or\nsupports weak encryption. An attacker monitors network traffic\n(e.g. at an insecure wireless network), downgrades connections\nfrom HTTPS to HTTP, intercepts requests, and steals the user's\nsession cookie. The attacker then replays this cookie and hijacks\nthe user's (authenticated) session, accessing or modifying the\nuser's private data. Instead of the above they could alter all\ntransported data, e.g. the recipient of a money transfer."),Object(r.b)("h3",{id:"scenario-3"},"Scenario #3:"),Object(r.b)("p",null,"The password database uses unsalted or simple\nhashes to store everyone's passwords. A file upload flaw allows\nan attacker to retrieve the password database. All the unsalted\nhashes can be exposed with a rainbow table of pre-calculated\nhashes. Hashes generated by simple or fast hash functions may\nbe cracked by GPUs, even if they were salted."),Object(r.b)("h2",{id:"how-to-prevent"},"How to Prevent"),Object(r.b)("p",null,"Do the following, at a minimum, and consult the references:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Classify data processed, stored, or transmitted by an\napplication. Identify which data is sensitive according to privacy\nlaws, regulatory requirements, or business needs."),Object(r.b)("li",{parentName:"ul"},"Apply controls as per the classification."),Object(r.b)("li",{parentName:"ul"},"Don‚Äôt store sensitive data unnecessarily. Discard it as soon as\npossible or use PCI DSS compliant tokenization or even\ntruncation. Data that is not retained cannot be stolen."),Object(r.b)("li",{parentName:"ul"},"Make sure to encrypt all sensitive data at rest."),Object(r.b)("li",{parentName:"ul"},"Ensure up-to-date and strong standard algorithms, protocols,\nand keys are in place; use proper key management."),Object(r.b)("li",{parentName:"ul"},"Encrypt all data in transit with secure protocols such as TLS\nwith perfect forward secrecy (PFS) ciphers, cipher prioritization\nby the server, and secure parameters. Enforce encryption\nusing directives like HTTP Strict Transport Security (HSTS)."),Object(r.b)("li",{parentName:"ul"},"Disable caching for responses that contain sensitive data."),Object(r.b)("li",{parentName:"ul"},"Store passwords using strong adaptive and salted hashing\nfunctions with a work factor (delay factor), such as ",Object(r.b)("a",i({parentName:"li"},{href:"https://www.cryptolux.org/index.php/Argon2"}),"Argon2"),",\n",Object(r.b)("a",i({parentName:"li"},{href:"https://wikipedia.org/wiki/Scrypt"}),"scrypt"),", ",Object(r.b)("a",i({parentName:"li"},{href:"https://wikipedia.org/wiki/Bcrypt"}),"bcrypt"),", or ",Object(r.b)("a",i({parentName:"li"},{href:"https://wikipedia.org/wiki/PBKDF2"}),"PBKDF2"),"."),Object(r.b)("li",{parentName:"ul"},"Verify independently the effectiveness of configuration and\nsettings.")),Object(r.b)("h2",{id:"hacking-playground"},"Hacking Playground"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://nodegoat.herokuapp.com/tutorial/a6"}),"üêê NodeGoat | A6 Sensitive Data Exposure")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://pwning.owasp-juice.shop/part2/sensitive-data-exposure.html"}),"üßÉ Pwning OWASP Juice Shop | A3 - Sensitive Data Exposure")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://application.security/free-application-security-training/owasp-top-10-session-fixation"}),"Kontra | Session Fixation"))),Object(r.b)("h2",{id:"references"},"References"),Object(r.b)("h3",{id:"owasp"},"OWASP"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html"}),"OWASP Cheat Sheet: Transport Layer Protection")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html"}),"OWASP Cheat Sheet: User Privacy Protection")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html"}),"OWASP Cheat Sheet: Password and Cryptographic Storage")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html"}),"OWASP Cheat Sheet: HSTS"))),Object(r.b)("h3",{id:"cwes"},"CWEs"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/220.html"}),"CWE-220: Exposure of sens. information through data queries")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/310.html"}),"CWE-310: Cryptographic Issues")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/331.html"}),"CWE-311: Missing Encryption")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/312.html"}),"CWE-312: Cleartext Storage of Sensitive Information")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/319.html"}),"CWE-319: Cleartext Transmission of Sensitive Information")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/326.html"}),"CWE-326: Weak Encryption")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/327.html"}),"CWE-327: Broken/Risky Crypto")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",i({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/359.html"}),"CWE-359: Exposure of Private Information (Privacy Violation)"))))}void 0!==l&&l&&l===Object(l)&&Object.isExtensible(l)&&!l.hasOwnProperty("__filemeta")&&Object.defineProperty(l,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/owasp_top_10/a3_sensitive_data_exposure.mdx"}}),l.isMDXComponent=!0},hxik:function(e,t,a){e.exports=a.p+"static/meme_02-d75c2ecbb8793d17f6ed734481672f35.png"},j1of:function(e,t,a){e.exports=a.p+"static/meme_03-e8d6e6ba29d7213b16afda8ac857dbe1.jpg"}}]);
//# sourceMappingURL=component---src-owasp-top-10-a-3-sensitive-data-exposure-mdx-0cf982aead9eeca7f0c3.js.map