(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{nEYR:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return r})),n.d(t,"default",(function(){return p}));n("5hJT"),n("W1QL"),n("K/PF"),n("t91x"),n("75LO"),n("PJhk"),n("mXGw");var a=n("/FXl"),i=n("TjRS");n("aD51");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var r={};void 0!==r&&r&&r===Object(r)&&Object.isExtensible(r)&&!r.hasOwnProperty("__filemeta")&&Object.defineProperty(r,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/http_headers/dont_sniff_mimetype.mdx"}});var s={_frontmatter:r},l=i.a;function p(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,["components"]);return Object(a.b)(l,o({},s,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h1",{id:"http-header-dont-sniff-mimetype"},"HTTP Header: Don't Sniff Mimetype"),Object(a.b)("h2",{id:"the-attack"},"The attack"),Object(a.b)("p",null,"MIME types are a way of determining what kind of file you’re looking at. PNG images have the type ",Object(a.b)("inlineCode",{parentName:"p"},"image/png"),"; JSON files are ",Object(a.b)("inlineCode",{parentName:"p"},"application/json"),"; JavaScript files are typically ",Object(a.b)("inlineCode",{parentName:"p"},"text/javascript"),". When your browser loads a file, it reads the server’s ",Object(a.b)("inlineCode",{parentName:"p"},"Content-Type")," header to determine what the thing is."),Object(a.b)("p",null,"Let’s say that your browser sees this:"),Object(a.b)("pre",null,Object(a.b)("code",o({parentName:"pre"},{className:"language-html"}),'<script src="https://example.com/my-javascript"><\/script>\n')),Object(a.b)("p",null,"It’ll go and load ",Object(a.b)("inlineCode",{parentName:"p"},"my-javascript")," from ",Object(a.b)("inlineCode",{parentName:"p"},"example.com"),". If ",Object(a.b)("inlineCode",{parentName:"p"},"example.com")," sends a ",Object(a.b)("inlineCode",{parentName:"p"},"Content-Type")," header of ",Object(a.b)("inlineCode",{parentName:"p"},"text/javascript"),", your browser will execute the contents of ",Object(a.b)("inlineCode",{parentName:"p"},"my-javascript")," as JavaScript."),Object(a.b)("p",null,"But what if ",Object(a.b)("inlineCode",{parentName:"p"},"my-javascript")," is an HTML page with a ",Object(a.b)("inlineCode",{parentName:"p"},"Content-Type")," of ",Object(a.b)("inlineCode",{parentName:"p"},"text/html"),"? If your browser does something called “MIME sniffing” (which some do), it will look at the contents of the file, decide if it looks like JavaScript, and execute it if so. This means that a server can send the wrong ",Object(a.b)("inlineCode",{parentName:"p"},"Content-Type")," and JavaScript can still get executed."),Object(a.b)("p",null,"This MIME sniffing can be an attack vector. A user could upload an image with the ",Object(a.b)("inlineCode",{parentName:"p"},".jpg")," file extension but its contents are actually HTML. Visiting that image could cause the browser to “run” the HTML page, which could contain malicious JavaScript! Perhaps the nastiest attack is called ",Object(a.b)("a",o({parentName:"p"},{href:"https://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/"}),"Rosetta Flash"),", which allows someone to load a malicious Flash plugin instead of data!"),Object(a.b)("h2",{id:"the-header"},"The header"),Object(a.b)("p",null,"The ",Object(a.b)("inlineCode",{parentName:"p"},"X-Content-Type-Options")," header tells browsers not to sniff MIME types. When this header is set to ",Object(a.b)("inlineCode",{parentName:"p"},"nosniff"),", browsers won’t sniff the MIME type—they will trust what the server says and block the resource if it’s wrong."),Object(a.b)("h2",{id:"the-code"},"The code"),Object(a.b)("p",null,"The ",Object(a.b)("inlineCode",{parentName:"p"},"noSniff")," middleware will set the ",Object(a.b)("inlineCode",{parentName:"p"},"X-Content-Type-Options")," header to ",Object(a.b)("inlineCode",{parentName:"p"},"nosniff")," for every request."),Object(a.b)("pre",null,Object(a.b)("code",o({parentName:"pre"},{className:"language-js"}),'const helmet = require(\'helmet\')\n\n//By default: Sets "X-Content-Type-Options: nosniff".\napp.use(helmet())\n\n// Sets "X-Content-Type-Options: nosniff".\napp.use(helmet.noSniff())\n')),Object(a.b)("h3",{id:"refs"},"Refs:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://helmetjs.github.io/docs/dont-sniff-mimetype"}),"Helmet | Don't Sniff Mimetype")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://blog.fox-it.com/2012/05/08/mime-sniffing-feature-or-vulnerability/"}),"Fox it | MIME Sniffing: feature or vulnerability?")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://blog.miki.it/2014/7/8/abusing-jsonp-with-rosetta-flash/"}),"Miki Blog | Abusing JSONP with Rosetta Flash")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"}),"MDN | X-Content-Type-Options")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/compatibility/gg622941(v=vs.85)?redirectedfrom=MSDN"}),"Microsoft | Reducing MIME type security risks"))))}void 0!==p&&p&&p===Object(p)&&Object.isExtensible(p)&&!p.hasOwnProperty("__filemeta")&&Object.defineProperty(p,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/http_headers/dont_sniff_mimetype.mdx"}}),p.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-http-headers-dont-sniff-mimetype-mdx-e60ff8c8c93d0d20866a.js.map