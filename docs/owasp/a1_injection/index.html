<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/cybersecurity-handbook/styles.2543ff947a193d7f33b1.css">@import url(https://fonts.googleapis.com/css?family=Inconsolata&display=swap);@import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap);</style><meta name="generator" content="Gatsby 2.20.11"/><title data-rh="true">A1 Injection | Cybersecurity Handbook</title><meta data-rh="true" name="description" content="My awesome app using docz"/><meta data-rh="true" property="og:title" content="A1 Injection"/><meta data-rh="true" property="og:description" content="My awesome app using docz"/><meta data-rh="true" property="og:type" content="website"/><meta data-rh="true" name="twitter:card" content="summary"/><meta data-rh="true" name="twitter:title" content="A1 Injection"/><meta data-rh="true" name="twitter:description" content="My awesome app using docz"/><meta data-rh="true" charSet="utf-8"/><link data-rh="true" rel="icon" type="image/png" href="./public/guidesmiths_logo.png"/><link as="script" rel="preload" href="/cybersecurity-handbook/webpack-runtime-11484c19b06e24a038e4.js"/><link as="script" rel="preload" href="/cybersecurity-handbook/framework-b48900d5a9d93cfeece4.js"/><link as="script" rel="preload" href="/cybersecurity-handbook/styles-2d7da9d2d6649ee2da47.js"/><link as="script" rel="preload" href="/cybersecurity-handbook/app-036a46d967ae9a7869d1.js"/><link as="script" rel="preload" href="/cybersecurity-handbook/bac1b955-bf168f33e289fde76acd.js"/><link as="script" rel="preload" href="/cybersecurity-handbook/5cd286446bb0219071d0c241a615bd26633322ed-c298033bff9b67cab161.js"/><link as="script" rel="preload" href="/cybersecurity-handbook/component---src-owasp-top-10-a-1-injection-mdx-c6f4bea7b5023af4afc2.js"/><link as="fetch" rel="preload" href="/cybersecurity-handbook/page-data/owasp/a1_injection/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/cybersecurity-handbook/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="1ouyflx">.css-1ouyflx{font-family:'Source Sans Pro',sans-serif;font-size:20px;font-weight:400;line-height:1.5;color:var(--theme-ui-colors-text,#2D3747);background-color:var(--theme-ui-colors-background,#FFFFFF);}</style><div class="css-1ouyflx"><style data-emotion-css="jrjj6h">.css-jrjj6h > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><style data-emotion-css="1ubpee3">.css-1ubpee3{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1ubpee3 > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><style data-emotion-css="hbri28">.css-hbri28{box-sizing:border-box;min-width:0;min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-hbri28 > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><div data-testid="layout" class="css-hbri28"><style data-emotion-css="1xva7m0">body{margin:0;padding:0;}.icon-link{display:none;}.with-overlay{overflow:hidden;}</style><style data-emotion-css="zf0iqh">.css-zf0iqh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}</style><style data-emotion-css="1tjxv7i">.css-1tjxv7i{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}</style><style data-emotion-css="238csb">.css-238csb{box-sizing:border-box;min-width:0;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}</style><main class="css-238csb"><style data-emotion-css="18wmtq">.css-18wmtq{background-color:var(--theme-ui-colors-header-bg,#F5F6F7);position:relative;z-index:1;border-bottom:1px solid var(--theme-ui-colors-border,#CED4DE);}</style><div data-testid="header" class="css-18wmtq"><style data-emotion-css="zankq9">.css-zankq9{display:none;position:absolute;top:calc(100% + 15px);left:30px;}@media screen and (max-width:57.5em){.css-zankq9{display:block;}}</style><style data-emotion-css="1s0wdqz">.css-1s0wdqz{box-sizing:border-box;min-width:0;display:none;position:absolute;top:calc(100% + 15px);left:30px;}@media screen and (max-width:57.5em){.css-1s0wdqz{display:block;}}</style><div class="css-1s0wdqz"><style data-emotion-css="4019lz">.css-4019lz{padding:0;outline:none;background:transparent;border:none;color:var(--theme-ui-colors-header-text,#2D3747);opacity:0.5;cursor:pointer;}.css-4019lz:hover{cursor:pointer;}</style><button class="css-4019lz"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button></div><style data-emotion-css="z6jak6">.css-z6jak6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding-left:32px;padding-right:32px;position:relative;height:80px;}</style><div class="css-z6jak6"><style data-emotion-css="xenp3v">.css-xenp3v{-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><style data-emotion-css="1abzlu">.css-1abzlu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><style data-emotion-css="ug0363">.css-ug0363{box-sizing:border-box;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><div data-testid="logo" class="css-ug0363"><style data-emotion-css="gyijir">.css-gyijir{font-weight:600;color:var(--theme-ui-colors-header-text,#2D3747);-webkit-text-decoration:none;text-decoration:none;}.css-gyijir:hover{color:var(--theme-ui-colors-primary,#0B5FFF);}</style><a class="css-gyijir" href="/cybersecurity-handbook/">Cybersecurity Handbook</a></div><style data-emotion-css="k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><style data-emotion-css="80zs6q">.css-80zs6q{box-sizing:border-box;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-80zs6q"><style data-emotion-css="1is33jg">.css-1is33jg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:12px;border:none;border-radius:9999px;background-color:var(--theme-ui-colors-header-button-bg,#0B5FFF);color:var(--theme-ui-colors-header-button-color,#FFFFFF);font-size:12px;font-weight:600;cursor:pointer;}</style><button aria-label="Switch to light mode" class="css-1is33jg"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></button></div></div></div><style data-emotion-css="1nfi0ai">.css-1nfi0ai{padding-top:0;padding-bottom:0;-webkit-flex:1;-ms-flex:1;flex:1;display:grid;grid-template-columns:250px minmax(0,1fr);min-height:100vh;}@media screen and (max-width:57.5em){.css-1nfi0ai{display:block;}}</style><div class="css-1nfi0ai"><style data-emotion-css="1tn7q1x">.css-1tn7q1x{z-index:999;position:fixed;top:81px;right:0;bottom:0;left:0;background:rgba(0,0,0,0.6);-webkit-transition:all .2s ease-out;transition:all .2s ease-out;visibility:hidden;opacity:0;}</style><style data-emotion-css="h4snl3">.css-h4snl3{box-sizing:border-box;min-width:0;z-index:999;position:fixed;top:81px;right:0;bottom:0;left:0;background:rgba(0,0,0,0.6);-webkit-transition:all .2s ease-out;transition:all .2s ease-out;visibility:hidden;opacity:0;}</style><div class="css-h4snl3"></div><style data-emotion-css="1ethd5x">.css-1ethd5x{padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:-webkit-sticky;position:sticky;top:0;z-index:1;min-width:0;max-height:100vh;border-right:1px solid var(--theme-ui-colors-border,#CED4DE);overflow:auto;-webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-sidebar-bg,#FFFFFF);}@media screen and (max-width:57.5em){.css-1ethd5x{z-index:9999;display:block;position:fixed;top:81px;left:0;bottom:0;width:256px;padding-left:32px;padding-right:32px;background-color:var(--theme-ui-colors-background,#FFFFFF);-webkit-transition:-webkit-transform .2s ease-out;-webkit-transition:transform .2s ease-out;transition:transform .2s ease-out;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}}</style><style data-emotion-css="1li9yso">.css-1li9yso{box-sizing:border-box;min-width:0;padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:-webkit-sticky;position:sticky;top:0;z-index:1;min-width:0;max-height:100vh;border-right:1px solid var(--theme-ui-colors-border,#CED4DE);overflow:auto;-webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-sidebar-bg,#FFFFFF);}@media screen and (max-width:57.5em){.css-1li9yso{z-index:9999;display:block;position:fixed;top:81px;left:0;bottom:0;width:256px;padding-left:32px;padding-right:32px;background-color:var(--theme-ui-colors-background,#FFFFFF);-webkit-transition:-webkit-transform .2s ease-out;-webkit-transition:transform .2s ease-out;transition:transform .2s ease-out;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}}</style><div data-testid="sidebar" class="css-1li9yso"><style data-emotion-css="lcm9hh">.css-lcm9hh{margin-bottom:16px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div data-testid="nav-search" class="css-lcm9hh"><style data-emotion-css="1mo6uhh">.css-1mo6uhh{color:var(--theme-ui-colors-border,#CED4DE);margin-right:8px;}</style><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-1mo6uhh"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><style data-emotion-css="1bbueiu">.css-1bbueiu{outline:none;background:none;border:none;color:var(--theme-ui-colors-text,#2D3747);font-size:14px;}</style><input placeholder="Type to search..." value="" class="css-1bbueiu"/></div><style data-emotion-css="1rqvyud">.css-1rqvyud{margin-top:8px;margin-bottom:8px;display:block;color:var(--theme-ui-colors-sidebar-navGroup,#2D3747);-webkit-text-decoration:none;text-decoration:none;font-size:16px;}.css-1rqvyud.active{color:var(--theme-ui-colors-sidebar-navLinkActive,#0B5FFF);}</style><a class="css-1rqvyud" href="/cybersecurity-handbook/">Welcome</a><style data-emotion-css="1ebprri">.css-1ebprri{margin-top:16px;margin-bottom:16px;}</style><div data-testid="nav-group" class="css-1ebprri"><style data-emotion-css="1c8kbwa">.css-1c8kbwa{margin-bottom:4px;font-size:16px;font-weight:500;color:var(--theme-ui-colors-sidebar-navGroup,#2D3747);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-1c8kbwa">About Cybersecurity<style data-emotion-css="cu2sly">.css-cu2sly{margin-left:4px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-align-self:baseline;-ms-flex-item-align:baseline;align-self:baseline;-webkit-transform:rotateX(0deg);-ms-transform:rotateX(0deg);transform:rotateX(0deg);-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;-webkit-transition:-webkit-transform .3s ease-in-out;-webkit-transition:transform .3s ease-in-out;transition:transform .3s ease-in-out;}</style><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-cu2sly"><polyline points="6 9 12 15 18 9"></polyline></svg></div><style data-emotion-css="1isemmb">.css-1isemmb{margin-left:8px;}</style><div data-testid="nav-group-links" class="css-1isemmb"></div></div><a class="css-1rqvyud" href="/cybersecurity-handbook/notable_security_incidents">Notable Security Incidents</a><div data-testid="nav-group" class="css-1ebprri"><div class="css-1c8kbwa">OWASP Top 10<style data-emotion-css="1scp5x8">.css-1scp5x8{margin-left:4px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-align-self:baseline;-ms-flex-item-align:baseline;align-self:baseline;-webkit-transform:rotateX(180deg);-ms-transform:rotateX(180deg);transform:rotateX(180deg);-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;-webkit-transition:-webkit-transform .3s ease-in-out;-webkit-transition:transform .3s ease-in-out;transition:transform .3s ease-in-out;}</style><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-1scp5x8"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/">Intro</a><a aria-current="page" class="css-1rqvyud active" href="/cybersecurity-handbook/owasp/a1_injection">A1 Injection</a><style data-emotion-css="1ooej63">.css-1ooej63{margin-top:8px;margin-bottom:8px;display:block;color:var(--theme-ui-colors-sidebar-tocLink,#67788a);-webkit-text-decoration:none;text-decoration:none;font-size:14px;margin-left:16px;position:relative;}.css-1ooej63.active{color:var(--theme-ui-colors-sidebar-tocLinkActive,#1D2330);}.css-1ooej63.active::before{content:"";position:absolute;display:block;top:2px;left:-8px;height:1rem;background-color:var(--theme-ui-colors-primary,#0B5FFF);-webkit-transition:width 200ms ease 0s;transition:width 200ms ease 0s;width:2px;border-radius:1px;}</style><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#definition">Definition</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#risk-factor-summary">Risk Factor Summary</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#context">Context</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#is-the-application-vulnerable">Is the Application Vulnerable?</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#conceptual-attacks">Conceptual Attacks</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#example-attack-scenarios">Example Attack Scenarios</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#how-to-prevent">How to Prevent</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#extra-mile-unexpected-injections">Extra mile: Unexpected injections</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#hacking-playground">Hacking Playground</a><a class=" css-1ooej63" href="/cybersecurity-handbook/owasp/a1_injection#references">References</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a2_broken_authentication">A2 Broken Authentication</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a3_sensitived_data_exposure">A3 Sensitive Data Exposure</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a4_xml_external_entities_xxe">A4 XML External Entities (XXE)</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a5_broken_access_control">A5 Broken Access Control</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a6_security_misconfiguration">A6 Security Misconfiguration</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a7_cross-site_scripting_xss">A7 Cross-site scripting (XSS)</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a8_insecure_deserialization">A8 Insecure Deserialization</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a9_using_components_with_known_vulnerabilities">A9 Using Components with Known Vulnerabilities</a><a class="css-1rqvyud" href="/cybersecurity-handbook/owasp/a10_insufficient_logging_and_monitoring">A10 Insufficient logging and monitoring</a></div></div><div data-testid="nav-group" class="css-1ebprri"><div class="css-1c8kbwa">Attacks explained<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-cu2sly"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"></div></div><div data-testid="nav-group" class="css-1ebprri"><div class="css-1c8kbwa">Security Design<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-cu2sly"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"></div></div><div data-testid="nav-group" class="css-1ebprri"><div class="css-1c8kbwa">OWASP Proactive Controls<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-cu2sly"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"></div></div><div data-testid="nav-group" class="css-1ebprri"><div class="css-1c8kbwa">HTTP Headers<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-cu2sly"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"></div></div><div data-testid="nav-group" class="css-1ebprri"><div class="css-1c8kbwa">Best practices<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-cu2sly"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"></div></div><a class="css-1rqvyud" href="/cybersecurity-handbook/tooling">Tooling</a><div data-testid="nav-group" class="css-1ebprri"><div class="css-1c8kbwa">Checklists<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-cu2sly"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"></div></div><a class="css-1rqvyud" href="/cybersecurity-handbook/testing_guides">Testing Guides</a><a class="css-1rqvyud" href="/cybersecurity-handbook/cheatsheets">Cheat Sheets</a><a class="css-1rqvyud" href="/cybersecurity-handbook/resources">Resources</a><a class="css-1rqvyud" href="/cybersecurity-handbook/acknowledgments_and_credits">Acknowledgments and credits</a></div><style data-emotion-css="1w3d2mg">.css-1w3d2mg{background-color:var(--theme-ui-colors-background,#FFFFFF);position:relative;max-width:1280px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;padding:32px;}@media screen and (max-width:57.5em){.css-1w3d2mg{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><style data-emotion-css="kjtkh5">.css-kjtkh5{width:100%;min-width:0;max-width:1280px;margin-left:auto;margin-right:auto;padding:32px;background-color:var(--theme-ui-colors-background,#FFFFFF);position:relative;max-width:1280px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;padding:32px;}@media screen and (max-width:57.5em){.css-kjtkh5{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><style data-emotion-css="1307vk3">.css-1307vk3{box-sizing:border-box;min-width:0;width:100%;min-width:0;max-width:1280px;margin-left:auto;margin-right:auto;padding:32px;background-color:var(--theme-ui-colors-background,#FFFFFF);position:relative;max-width:1280px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;padding:32px;}@media screen and (max-width:57.5em){.css-1307vk3{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><div data-testid="main-container" class="css-1307vk3"><style data-emotion-css="1vci3bl">.css-1vci3bl{padding:0;margin:0;margin-bottom:16px;font-size:48px;font-family:'Source Sans Pro',sans-serif;line-height:1.125;font-weight:700;}</style><h1 id="a1-injection" class="css-1vci3bl">A1 Injection</h1><style data-emotion-css="1ftn47p">.css-1ftn47p{padding:0;margin:0;margin-bottom:16px;}</style><p class="css-1ftn47p"><style data-emotion-css="1a2e1jm">.css-1a2e1jm{padding:0;margin:0;margin-bottom:16px;max-width:100%;}</style><img alt="xkcd - Exploits of a Mom" src="/cybersecurity-handbook/static/xkcd_327-3f89e3f5f26349e27df9cd2bc1266a96.png" class="css-1a2e1jm"/>
<em class="css-0">Image from <style data-emotion-css="1iv9jyz">.css-1iv9jyz{color:var(--theme-ui-colors-primary,#0B5FFF);-webkit-text-decoration:none;text-decoration:none;}.css-1iv9jyz:hover{color:secondary;-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://xkcd.com/327/" class="css-1iv9jyz">xkcd</a></em></p><style data-emotion-css="r53osx">.css-r53osx{padding:0;margin:0;margin-bottom:16px;font-size:32px;font-family:'Source Sans Pro',sans-serif;line-height:1.125;font-weight:700;}</style><h2 id="definition" class="css-r53osx"><style data-emotion-css="1r0pe6c">.css-1r0pe6c{color:inherit;-webkit-text-decoration:none;text-decoration:none;}.css-1r0pe6c:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="#definition" class="css-1r0pe6c">Definition</a></h2><p class="css-1ftn47p">Injection flaws, such as SQL, NoSQL, OS, and LDAP injection, occur when untrusted data is sent
to an interpreter as part of a command or query. The attacker’s hostile data can trick the
interpreter into executing unintended commands or accessing data without proper authorization.</p><h2 id="risk-factor-summary" class="css-r53osx"><a href="#risk-factor-summary" class="css-1r0pe6c">Risk Factor Summary</a></h2><style data-emotion-css="cvh4i0">.css-cvh4i0{padding:0;margin:0;margin-bottom:16px;list-style-position:outside;list-style-image:none;margin-left:16px;}</style><ul class="css-cvh4i0"><style data-emotion-css="q43a5f">.css-q43a5f{margin-bottom:4px;padding-left:0;}.css-q43a5f ol{margin-top:8px;margin-bottom:8px;margin-left:16px;}.css-q43a5f ul{margin-top:8px;margin-bottom:8px;margin-left:16px;}.css-q43a5f p{margin-bottom:8px;}</style><li class="css-q43a5f">Score: 8.0</li><li class="css-q43a5f">Attack Vectors Exploitability: 3</li><li class="css-q43a5f">Security Weakness Prevalence: 2</li><li class="css-q43a5f">Security Weakness Detectability: 3</li><li class="css-q43a5f">Impact Technical: 3</li></ul><h2 id="context" class="css-r53osx"><a href="#context" class="css-1r0pe6c">Context</a></h2><iframe width="100%" height="450" src="https://www.youtube.com/embed/rWHvp7rUka8"></iframe><p class="css-1ftn47p">Almost any source of data can be an injection vector, environment
variables, parameters, external and
internal web services, and all types of
users. <a href="https://owasp.org/www-community/Injection_Flaws" class="css-1iv9jyz">Injection flaws</a> occur when an
attacker can send hostile data to an
interpreter.</p><p class="css-1ftn47p">Injection flaws are very prevalent, particularly in
legacy code. Injection vulnerabilities are often found
in SQL, LDAP, XPath, or NoSQL queries, OS
commands, XML parsers, SMTP headers,
expression languages, and ORM queries.</p><p class="css-1ftn47p">Injection flaws are easy to discover when examining
code. Scanners and fuzzers can help attackers find
injection flaws.</p><p class="css-1ftn47p">Injection can result in data loss,
corruption, or disclosure to
unauthorized parties, loss of
accountability, or denial of access.</p><p class="css-1ftn47p">Injection can sometimes lead to
complete host takeover.</p><p class="css-1ftn47p">The business impact depends on the
needs of the application and data.</p><h2 id="is-the-application-vulnerable" class="css-r53osx"><a href="#is-the-application-vulnerable" class="css-1r0pe6c">Is the Application Vulnerable?</a></h2><p class="css-1ftn47p">An application is vulnerable to attack when:</p><ul class="css-cvh4i0"><li class="css-q43a5f">User-supplied data is not validated, filtered, or sanitized by the
application.</li><li class="css-q43a5f">Dynamic queries or non-parameterized calls without contextaware escaping are used directly in the interpreter.</li><li class="css-q43a5f">Hostile data is used within object-relational mapping (ORM)
search parameters to extract additional, sensitive records.</li><li class="css-q43a5f">Hostile data is directly used or concatenated, such that the
SQL or command contains both structure and hostile data in
dynamic queries, commands, or stored procedures.
Some of the more common injections are SQL, NoSQL, OS
command, Object Relational Mapping (ORM), LDAP, and
Expression Language (EL) or Object Graph Navigation Library
(OGNL) injection. The concept is identical among all interpreters.
Source code review is the best method of detecting if
applications are vulnerable to injections, closely followed by
thorough automated testing of all parameters, headers, URL,
cookies, JSON, SOAP, and XML data inputs. Organizations can
include static source (SAST) and dynamic application test
(DAST) tools into the CI/CD pipeline to identify newly introduced
injection flaws prior to production deployment. </li></ul><h2 id="conceptual-attacks" class="css-r53osx"><a href="#conceptual-attacks" class="css-1r0pe6c">Conceptual Attacks</a></h2><style data-emotion-css="1yfs3hu">.css-1yfs3hu{padding:0;margin:0;margin-bottom:16px;font-size:24px;font-family:'Source Sans Pro',sans-serif;line-height:1.125;font-weight:700;}</style><h3 id="scenario-1" class="css-1yfs3hu"><a href="#scenario-1" class="css-1r0pe6c">Scenario #1:</a></h3><p class="css-1ftn47p">An application uses untrusted data in the
construction of the following vulnerable SQL call:</p><style data-emotion-css="1h0sj8d">.css-1h0sj8d{padding:16px;margin:0;margin-bottom:32px;font-size:85%;margin-top:32px;text-align:left;font-family:Inconsolata;border-radius:4px;}.css-1h0sj8d dark{[object Object];}.css-1h0sj8d light{[object Object];}</style><div><style data-emotion-css="155ufdz">.css-155ufdz{font-size:85%;font-family:Inconsolata;}</style><style data-emotion-css="1uzskhg">.css-1uzskhg{padding:16px;margin:0;margin-bottom:32px;font-size:85%;margin-top:32px;text-align:left;font-family:Inconsolata;border-radius:4px;font-size:85%;font-family:Inconsolata;}.css-1uzskhg dark{[object Object];}.css-1uzskhg light{[object Object];}</style><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> query </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">SELECT * FROM accounts WHERE</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token template-string string css-1baulvz" style="color:#e3116c">custID=&#x27;</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">request</span><span class="token template-string interpolation punctuation css-1baulvz" style="color:#393A34">.</span><span class="token template-string interpolation function css-1baulvz" style="color:#d73a49">getParameter</span><span class="token template-string interpolation punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string interpolation string css-1baulvz" style="color:#e3116c">&quot;id&quot;</span><span class="token template-string interpolation punctuation css-1baulvz" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c">&#x27;</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><h3 id="scenario-2" class="css-1yfs3hu"><a href="#scenario-2" class="css-1r0pe6c">Scenario #2:</a></h3><p class="css-1ftn47p">Similarly, an application’s blind trust in frameworks
may result in queries that are still vulnerable, (e.g. Hibernate
Query Language (HQL)):</p><div><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token maybe-class-name css-1baulvz">HQLQuery</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> session</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">createQuery</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">FROM accounts</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token template-string string css-1baulvz" style="color:#e3116c">WHERE custID=&#x27;</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">request</span><span class="token template-string interpolation punctuation css-1baulvz" style="color:#393A34">.</span><span class="token template-string interpolation function css-1baulvz" style="color:#d73a49">getParameter</span><span class="token template-string interpolation punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string interpolation string css-1baulvz" style="color:#e3116c">&quot;id&quot;</span><span class="token template-string interpolation punctuation css-1baulvz" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c">&#x27;</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><p class="css-1ftn47p">In both cases, the attacker modifies the ‘id’ parameter value in
their browser to send: <style data-emotion-css="ueqitl">.css-ueqitl{font-family:Inconsolata;}</style><code class="css-ueqitl">&#x27; or &#x27;1&#x27;=&#x27;1</code>. For example:</p><div><pre class="prism-code language-css-155ufdz css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">http://example.com/app/accountView?id=&#x27; or &#x27;1&#x27;=&#x27;1</span></div></pre></div><p class="css-1ftn47p">This changes the meaning of both queries to return all the
records from the accounts table, since <code class="css-ueqitl">&#x27;1&#x27;=&#x27;1</code> will always evaluate TRUE.
More dangerous attacks could modify or delete data, or even invoke stored procedures.</p><h2 id="example-attack-scenarios" class="css-r53osx"><a href="#example-attack-scenarios" class="css-1r0pe6c">Example Attack Scenarios</a></h2><h3 id="sql-injection" class="css-1yfs3hu"><a href="#sql-injection" class="css-1r0pe6c">SQL Injection:</a></h3><p class="css-1ftn47p">This example is based on  <a href="http://scottksmith.com/blog/2015/06/08/secure-node-apps-against-owasp-top-10-injection/" class="css-1iv9jyz">Scott Smith example about Injections</a></p><p class="css-1ftn47p">Our server code:</p><div><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> mysqlConfig </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token operator css-1baulvz" style="color:#393A34">/</span><span class="token plain css-1baulvz">config</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> express </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> bodyParser </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;body-parser&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> mysql  </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;mysql&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> connection </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> mysql</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">createConnection</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">mysqlConfig</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> app </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">express</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">//Middleware</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">use</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">bodyParser</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">urlencoded</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">// Routes</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">post</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;/login&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">req</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> user</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> pass </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> req</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">body</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> sql </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">SELECT * FROM users WHERE user = &#x27;</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">user</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c">&#x27; AND pass = &#x27;</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">pass</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c">&#x27;</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token console class-name css-1baulvz">console</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">log</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">SQL to be executed: </span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">sql</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">// connection.query(sql, (err, results) =&gt; {})</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">listen</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token number css-1baulvz" style="color:#36acaa">8080</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><p class="css-1ftn47p">our malicious request:</p><div><pre class="prism-code language-css-155ufdz css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">POST /login HTTP/1.1</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">Host: example.com</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">Content-Type: application/x-www-form-urlencoded</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">user=admin&#x27;--&amp;pass=pass</span></div></pre></div><p class="css-1ftn47p">The final query is:</p><div><pre class="language-sql prism-code language-sql css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token keyword css-1baulvz" style="color:#00009f">SELECT</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">*</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">FROM</span><span class="token plain css-1baulvz"> users </span><span class="token keyword css-1baulvz" style="color:#00009f">WHERE</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">user</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">--&#x27; AND pass = &#x27;pass&#x27;</span></div></pre></div><p class="css-1ftn47p">The problem here is that <code class="css-ueqitl">&quot;--&quot;</code> renders everything that follows as a comment, thus returning the user info regardless of the password.</p><p class="css-1ftn47p">In this particular case the mitigation can be done by using <a href="https://github.com/mysqljs/mysql#escaping-query-values" class="css-1iv9jyz"><code class="css-ueqitl">escape</code> function built-it in <code class="css-ueqitl">mysql</code> library</a>.</p><div><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">//...</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> connection </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> mysql</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">createConnection</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">mysqlConfig</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">//..</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">post</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;/login&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">req</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> user </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> connection</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">escape</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">req</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">body</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">user</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> pass </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> connection</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">escape</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">req</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">body</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">pass</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> sql </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">SELECT * FROM users WHERE user = &#x27;</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">user</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c">&#x27; AND pass = &#x27;</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">pass</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c">&#x27;</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token console class-name css-1baulvz">console</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">log</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">SQL to be executed: </span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">sql</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">// connection.query(sql, (err, results) =&gt; {})</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">//..</span></div></pre></div><p class="css-1ftn47p">Using the previous malicious payload you get a safe query:</p><div><pre class="language-sql prism-code language-sql css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token keyword css-1baulvz" style="color:#00009f">SELECT</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">*</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">FROM</span><span class="token plain css-1baulvz"> users </span><span class="token keyword css-1baulvz" style="color:#00009f">WHERE</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">user</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;admin&#x27;&#x27;--&#x27;</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">AND</span><span class="token plain css-1baulvz"> pass </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;pass&#x27;</span></div></pre></div><h3 id="non-sql-injection" class="css-1yfs3hu"><a href="#non-sql-injection" class="css-1r0pe6c">NON-SQL Injection:</a></h3><p class="css-1ftn47p">This example is based on  <a href="http://scottksmith.com/blog/2015/06/08/secure-node-apps-against-owasp-top-10-injection/" class="css-1iv9jyz">Scott Smith example about Injections</a></p><p class="css-1ftn47p">Our server code:</p><div><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token maybe-class-name css-1baulvz">MongoClient</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;mongodb&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access maybe-class-name css-1baulvz">MongoClient</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> dbName</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> url </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token operator css-1baulvz" style="color:#393A34">/</span><span class="token plain css-1baulvz">config</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">mongoConfig</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> express </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> bodyParser </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;body-parser&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> app </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">express</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">let</span><span class="token plain css-1baulvz"> db</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">// DB Connection</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token maybe-class-name css-1baulvz">MongoClient</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">connect</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">url</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">err</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> client</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">if</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">err</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">throw</span><span class="token plain css-1baulvz"> err</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token console class-name css-1baulvz">console</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">log</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&quot;Connected successfully to MongoDB&quot;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  db </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> client</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">db</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">dbName</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">listen</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token number css-1baulvz" style="color:#36acaa">8080</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">//Middleware</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">use</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">bodyParser</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">urlencoded</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">// Routes</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">post</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;/login&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">req</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> user</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> pass </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> req</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">body</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  db</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">users</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">find</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz">user</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> user</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> pass</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> pass</span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><p class="css-1ftn47p">our malicious request:</p><div><pre class="prism-code language-css-155ufdz css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">POST /login HTTP/1.1</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">Host: example.com</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">Content-Type: application/json</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">{</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    &quot;user&quot;: {&quot;$gt&quot;: &quot;&quot;},</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    &quot;pass&quot;: {&quot;$gt&quot;: &quot;&quot;}</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">}</span></div></pre></div><p class="css-1ftn47p">The final query will return all the users within the user collection</p><div><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">db</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">users</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">find</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz">user</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;$gt&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> pass</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;$gt&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><p class="css-1ftn47p">In this particular case the mitigation can be done by using an explicit query selector.</p><div><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">post</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;/login&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">req</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> user</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> pass </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> req</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">body</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  db</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">users</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">find</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz">user</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> $</span><span class="token keyword css-1baulvz" style="color:#00009f">in</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">[</span><span class="token plain css-1baulvz">user</span><span class="token punctuation css-1baulvz" style="color:#393A34">]</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> pass</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> $</span><span class="token keyword css-1baulvz" style="color:#00009f">in</span><span class="token punctuation css-1baulvz" style="color:#393A34">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">[</span><span class="token plain css-1baulvz">pass</span><span class="token punctuation css-1baulvz" style="color:#393A34">]</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><p class="css-1ftn47p">Using the previous malicious payload, you get a safe query now:</p><div><pre class="language-sql prism-code language-sql css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">db</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token plain css-1baulvz">users</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token plain css-1baulvz">find</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">{</span><span class="token keyword css-1baulvz" style="color:#00009f">user</span><span class="token plain css-1baulvz">: { $</span><span class="token operator css-1baulvz" style="color:#393A34">in</span><span class="token plain css-1baulvz">: </span><span class="token punctuation css-1baulvz" style="color:#393A34">[</span><span class="token plain css-1baulvz">{ </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;$gt&#x27;</span><span class="token plain css-1baulvz">: </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain css-1baulvz"> }</span><span class="token punctuation css-1baulvz" style="color:#393A34">]</span><span class="token plain css-1baulvz"> }</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> pass: { $</span><span class="token operator css-1baulvz" style="color:#393A34">in</span><span class="token plain css-1baulvz">: </span><span class="token punctuation css-1baulvz" style="color:#393A34">[</span><span class="token plain css-1baulvz">{ </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;$gt&#x27;</span><span class="token plain css-1baulvz">: </span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain css-1baulvz"> }</span><span class="token punctuation css-1baulvz" style="color:#393A34">]</span><span class="token plain css-1baulvz"> }}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><h3 id="os-command-injection" class="css-1yfs3hu"><a href="#os-command-injection" class="css-1r0pe6c">OS Command Injection:</a></h3><p class="css-1ftn47p">In this case we want to use <a href="https://github.com/ytdl-org/youtube-dl/blob/master/README.md" class="css-1iv9jyz">youtube-dl</a> to download a cool <a href="https://www.youtube.com/watch?v=KEkrWRHCDQU" class="css-1iv9jyz">youtube video</a> to our local machine.</p><p class="css-1ftn47p">As <code class="css-ueqitl">youtube-dl</code> is a Python library we will use <a href="https://nodejs.org/api/child_process.html" class="css-1iv9jyz">process child</a> to run it in Nodejs. </p><p class="css-1ftn47p">Note: This example is non very common, but is much better than the typical <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval" class="css-1iv9jyz"><code class="css-ueqitl">eval()</code></a> example.</p><p class="css-1ftn47p">Our server code:</p><div><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> exec </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;child_process&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> express </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> app </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">express</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">// Routes</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">get</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;/download_video/:id&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">req</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> id </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> req</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">params</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> cmd </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">youtube-dl https://www.youtube.com/watch\?v\=</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">id</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token function css-1baulvz" style="color:#d73a49">exec</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">cmd</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">error</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> stdout</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> stderr</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      </span><span class="token keyword css-1baulvz" style="color:#00009f">if</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">error </span><span class="token operator css-1baulvz" style="color:#393A34">||</span><span class="token plain css-1baulvz"> stderr</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">return</span><span class="token plain css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">status</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token number css-1baulvz" style="color:#36acaa">500</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">send</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">😱 The video with id:</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">id</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c"> was not downloaded!</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      res</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">send</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">🎉 Video with id:</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">id</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c"> was downloaded!. </span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">stdout</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">listen</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token number css-1baulvz" style="color:#36acaa">8080</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><p class="css-1ftn47p">Our malicious request:</p><div><pre class="prism-code language-css-155ufdz css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">GET /download_video/KEkrWRHCDQU; printenv</span></div></pre></div><p class="css-1ftn47p">This request will be translated to <code class="css-ueqitl">youtube-dl https://www.youtube.com/watch?v=KEkrWRHCDQU; printenv</code>. So will include all the enviromental variables in the response.</p><p class="css-1ftn47p">To prevent this specific attack you can use a regex to validate the <a href="https://markmail.org/message/jb6nsveqs7hya5la" class="css-1iv9jyz">Youtube video id</a> with a regex: <code class="css-ueqitl">/^[a-zA-Z0-9_-]{11}$/</code> and avoid to include the <code class="css-ueqitl">stdout</code> or raw errors in the response.</p><p class="css-1ftn47p">Our server code:</p><div><pre class="language-js prism-code language-js css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">//..</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token function-variable function css-1baulvz" style="color:#d73a49">idValidation</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">id</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> re </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token regex css-1baulvz" style="color:#36acaa">/^[a-zA-Z0-9_-]{11}$/</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    </span><span class="token keyword css-1baulvz" style="color:#00009f">return</span><span class="token plain css-1baulvz"> re</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">test</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token known-class-name class-name css-1baulvz">String</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">id</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz" style="display:inline-block"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">// Routes</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">get</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;/download_video/:id&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">req</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"> id </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> req</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token property-access css-1baulvz">params</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">if</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token operator css-1baulvz" style="color:#393A34">!</span><span class="token function css-1baulvz" style="color:#d73a49">idValidation</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">id</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">return</span><span class="token plain css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">status</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token number css-1baulvz" style="color:#36acaa">400</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">send</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&quot;You sent an invalid id!&quot;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz" style="color:#00009f">const</span><span class="token plain css-1baulvz"> cmd </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">youtube-dl https://www.youtube.com/watch\?v\=</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">id</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token function css-1baulvz" style="color:#d73a49">exec</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">cmd</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">error</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> stdout</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> stderr</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz" style="color:#393A34">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      </span><span class="token keyword css-1baulvz" style="color:#00009f">if</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token plain css-1baulvz">error </span><span class="token operator css-1baulvz" style="color:#393A34">||</span><span class="token plain css-1baulvz"> stderr</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">return</span><span class="token plain css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">status</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token number css-1baulvz" style="color:#36acaa">500</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">send</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">😱 The video with id:</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">id</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c"> was not downloaded!</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      res</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">send</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token template-string string css-1baulvz" style="color:#e3116c">🎉 Video with id:</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">${</span><span class="token template-string interpolation css-1baulvz">id</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz" style="color:#393A34">}</span><span class="token template-string string css-1baulvz" style="color:#e3116c"> was downloaded!.</span><span class="token template-string template-punctuation string css-1baulvz" style="color:#e3116c">`</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz" style="color:#999988;font-style:italic">//..</span></div></pre></div><p class="css-1ftn47p">Note: These kind of bugs in the design can easily lead to Backdoors. Check out <a href="https://snyk.io/blog/what-is-a-backdoor/" class="css-1iv9jyz">this post for more details</a>. </p><h3 id="external-content-injection" class="css-1yfs3hu"><a href="#external-content-injection" class="css-1r0pe6c">External content Injection:</a></h3><p class="css-1ftn47p">It is very common to use Content Delivery Networks (CDNs) to speed up our static content (css, js, etc...). If we are using a third party CDN we must use <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity" class="css-1iv9jyz">Subresource Integrity
validation</a> in our HTML in order to prevent the execution on malicious content in case that the CDN is compromised and the files replaced by malicious ones.</p><div><pre class="language-html prism-code language-html css-1uzskhg" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;</span><span class="token tag css-1baulvz" style="color:#00009f">script</span><span class="token tag css-1baulvz" style="color:#00009f"> </span><span class="token tag attr-name css-1baulvz" style="color:#00a4db">src</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">=</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">&quot;</span><span class="token tag attr-value css-1baulvz" style="color:#e3116c">https://example.com/example-framework.js</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">&quot;</span><span class="token tag css-1baulvz" style="color:#00009f"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token tag css-1baulvz" style="color:#00009f">    </span><span class="token tag attr-name css-1baulvz" style="color:#00a4db">integrity</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">=</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">&quot;</span><span class="token tag attr-value css-1baulvz" style="color:#e3116c">sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">&quot;</span><span class="token tag css-1baulvz" style="color:#00009f"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token tag css-1baulvz" style="color:#00009f">    </span><span class="token tag attr-name css-1baulvz" style="color:#00a4db">crossorigin</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">=</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">&quot;</span><span class="token tag attr-value css-1baulvz" style="color:#e3116c">anonymous</span><span class="token tag attr-value punctuation css-1baulvz" style="color:#393A34">&quot;</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token script language-javascript css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token script language-javascript css-1baulvz"></span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;/</span><span class="token tag css-1baulvz" style="color:#00009f">script</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span></div></pre></div><p class="css-1ftn47p">As you can see the <code class="css-ueqitl">integrity</code> property contains the hashed value of the file that we&#x27;re expecting. This will allow the browser to check the integrity of the files downloaded before the execution.</p><p class="css-1ftn47p">Note: Most of the CDN services already had included this features, please use them</p><h2 id="how-to-prevent" class="css-r53osx"><a href="#how-to-prevent" class="css-1r0pe6c">How to Prevent</a></h2><h3 id="general-advice" class="css-1yfs3hu"><a href="#general-advice" class="css-1r0pe6c">General advice</a></h3><p class="css-1ftn47p">Preventing injection requires keeping data separate from
commands and queries</p><ul class="css-cvh4i0"><li class="css-q43a5f">The preferred option is to use a safe API, which avoids the use
of the interpreter entirely or provides a parameterized interface,
or migrate to use Object Relational Mapping Tools (ORMs).
Note: Even when parameterized, stored procedures can still
introduce SQL injection if PL/SQL or T-SQL concatenates
queries and data, or executes hostile data with EXECUTE
IMMEDIATE or exec().</li><li class="css-q43a5f">Use positive or &quot;whitelist&quot; server-side input validation. This is
not a complete defense as many applications require special
characters, such as text areas or APIs for mobile applications.</li><li class="css-q43a5f">For any residual dynamic queries, escape special characters
using the specific escape syntax for that interpreter.
Note: SQL structure such as table names, column names, and
so on cannot be escaped, and thus user-supplied structure
names are dangerous. This is a common issue in report-writing
software.</li><li class="css-q43a5f">Use LIMIT and other SQL controls within queries to prevent
mass disclosure of records in case of SQL injection.</li></ul><h3 id="keys-to-mitigate" class="css-1yfs3hu"><a href="#keys-to-mitigate" class="css-1r0pe6c">Keys to mitigate</a></h3><ul class="css-cvh4i0"><li class="css-q43a5f">Validate and sanitize any user input</li><li class="css-q43a5f">Strongly type your parameters</li><li class="css-q43a5f">Use parameterized queries for databases</li><li class="css-q43a5f">Configure your database account with the minimum permissions possible</li></ul><h2 id="extra-mile-unexpected-injections" class="css-r53osx"><a href="#extra-mile-unexpected-injections" class="css-1r0pe6c">Extra mile: Unexpected injections</a></h2><p class="css-1ftn47p"><img alt="Car with an SQL injection in as a plate" src="/cybersecurity-handbook/static/car_injection-2e00b0b826b0f38a80b279d95af052e5.jpg" class="css-1a2e1jm"/>
<em class="css-0">Image from <a href="https://backtrackacademy.com/articulo/sql-injection-god-level-mito-o-realidad" class="css-1iv9jyz">backtrackacademy</a></em></p><p class="css-1ftn47p">You always must sanitize all the Inputs. No matter where they came from. Any non-controller input can be a very harmful. </p><h2 id="hacking-playground" class="css-r53osx"><a href="#hacking-playground" class="css-1r0pe6c">Hacking Playground</a></h2><ul class="css-cvh4i0"><li class="css-q43a5f"><a href="https://nodegoat.herokuapp.com/tutorial/a1" class="css-1iv9jyz">🐐 NodeGoat | A1 - Injection</a></li><li class="css-q43a5f"><a href="https://pwning.owasp-juice.shop/part2/injection.html" class="css-1iv9jyz">🧃 Pwning OWASP Juice Shop | A1 - Injection</a></li><li class="css-q43a5f"><a href="https://application.security/free-application-security-training/owas-top-10-sql-injection" class="css-1iv9jyz">Kontra | SQL Injection</a></li></ul><h2 id="references" class="css-r53osx"><a href="#references" class="css-1r0pe6c">References</a></h2><h3 id="owasp" class="css-1yfs3hu"><a href="#owasp" class="css-1r0pe6c">OWASP</a></h3><ul class="css-cvh4i0"><li class="css-q43a5f"><a href="https://owasp.org/www-project-proactive-controls/" class="css-1iv9jyz">OWASP Proactive Controls: Parameterize Queries</a></li><li class="css-q43a5f"><a href="https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html" class="css-1iv9jyz">OWASP Cheat Sheet: Injection Prevention</a></li><li class="css-q43a5f"><a href="https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html" class="css-1iv9jyz">OWASP Cheat Sheet: SQL Injection Prevention</a></li><li class="css-q43a5f"><a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html" class="css-1iv9jyz">OWASP Cheat Sheet: Query Parameterization</a></li></ul><h3 id="cwes" class="css-1yfs3hu"><a href="#cwes" class="css-1r0pe6c">CWEs</a></h3><ul class="css-cvh4i0"><li class="css-q43a5f"><a href="https://cwe.mitre.org/data/definitions/77.html" class="css-1iv9jyz">CWE-77: Command Injection</a></li><li class="css-q43a5f"><a href="https://cwe.mitre.org/data/definitions/89.html" class="css-1iv9jyz">CWE-89: SQL Injection</a></li><li class="css-q43a5f"><a href="https://cwe.mitre.org/data/definitions/94.html" class="css-1iv9jyz">CWE-94: Improper Control of Generation of Code (&#x27;Code Injection&#x27;)</a>
- <a href="https://cwe.mitre.org/data/definitions/95.html" class="css-1iv9jyz">CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code (&#x27;Eval Injection&#x27;)</a></li><li class="css-q43a5f"><a href="https://cwe.mitre.org/data/definitions/116.html" class="css-1iv9jyz">CWE-116: Improper Encoding or Escaping of Output</a></li><li class="css-q43a5f"><a href="https://cwe.mitre.org/data/definitions/564.html" class="css-1iv9jyz">CWE-564: Hibernate Injection</a></li><li class="css-q43a5f"><a href="https://cwe.mitre.org/data/definitions/917.html" class="css-1iv9jyz">CWE-917: Expression Language Injection</a></li></ul><h3 id="other" class="css-1yfs3hu"><a href="#other" class="css-1r0pe6c">Other</a></h3><ul class="css-cvh4i0"><li class="css-q43a5f"><a href="http://scottksmith.com/blog/2015/06/08/secure-node-apps-against-owasp-top-10-injection/" class="css-1iv9jyz">Scott Smith | Secure Node Apps Against OWASP Top 10 - Injection</a></li><li class="css-q43a5f"><a href="https://snyk.io/blog/what-is-a-backdoor/" class="css-1iv9jyz">Snyk | What is a backdoor? Let’s build one with Node.js</a></li></ul></div></div></main></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/owasp/a1_injection";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-036a46d967ae9a7869d1.js"],"component---src-acknowledgments-and-credits-mdx":["/component---src-acknowledgments-and-credits-mdx-3ab5b61ca6f268a318bb.js"],"component---src-cheatsheets-mdx":["/component---src-cheatsheets-mdx-7091646954930b81c64c.js"],"component---src-index-mdx":["/component---src-index-mdx-ff68e78eee2560122813.js"],"component---src-notable-security-incidents-mdx":["/component---src-notable-security-incidents-mdx-1cd6368fb2df9ac1868d.js"],"component---src-resources-mdx":["/component---src-resources-mdx-eb21b5b2534cad1920c2.js"],"component---src-testing-guides-mdx":["/component---src-testing-guides-mdx-f319d31a9c94bac465f0.js"],"component---src-tooling-mdx":["/component---src-tooling-mdx-b60b65d900396bf9c0e5.js"],"component---src-about-cybersecurity-common-attacks-mdx":["/component---src-about-cybersecurity-common-attacks-mdx-5cca3a10385126b97ca5.js"],"component---src-about-cybersecurity-cryptography-mdx":["/component---src-about-cybersecurity-cryptography-mdx-0f999dbaaf3be15736b3.js"],"component---src-about-cybersecurity-cyber-kill-chain-ckc-mdx":["/component---src-about-cybersecurity-cyber-kill-chain-ckc-mdx-1ea8a458ace90f18cd26.js"],"component---src-about-cybersecurity-intro-mdx":["/component---src-about-cybersecurity-intro-mdx-7d91c6cd37f098a27419.js"],"component---src-about-cybersecurity-state-open-source-mdx":["/component---src-about-cybersecurity-state-open-source-mdx-5b67424fc9e25bd37a91.js"],"component---src-attacks-explained-buffer-mdx":["/component---src-attacks-explained-buffer-mdx-9b047b0b70a729182898.js"],"component---src-attacks-explained-clickjacking-mdx":["/component---src-attacks-explained-clickjacking-mdx-abf140ea9c9ee886d3fc.js"],"component---src-attacks-explained-csrf-mdx":["/component---src-attacks-explained-csrf-mdx-e90ef83afc06017223b0.js"],"component---src-attacks-explained-css-exfil-mdx":["/component---src-attacks-explained-css-exfil-mdx-b7fc8be0d0ee1ef44ece.js"],"component---src-attacks-explained-exhausting-system-resources-mdx":["/component---src-attacks-explained-exhausting-system-resources-mdx-2ebe571a0c7911b67869.js"],"component---src-attacks-explained-fork-bomb-mdx":["/component---src-attacks-explained-fork-bomb-mdx-980107fba4cba5f63bd2.js"],"component---src-attacks-explained-http-parameter-pollution-mdx":["/component---src-attacks-explained-http-parameter-pollution-mdx-9f4d4e4d012c9fbf9539.js"],"component---src-attacks-explained-insecure-randomness-mdx":["/component---src-attacks-explained-insecure-randomness-mdx-01a5e474bcad45ffb3f2.js"],"component---src-attacks-explained-intro-mdx":["/component---src-attacks-explained-intro-mdx-2653a25d7868c49f784d.js"],"component---src-attacks-explained-leaking-application-secrets-mdx":["/component---src-attacks-explained-leaking-application-secrets-mdx-117bb17748fa8cb74abc.js"],"component---src-attacks-explained-lockfile-mdx":["/component---src-attacks-explained-lockfile-mdx-ab3b08124f3f0377cffa.js"],"component---src-attacks-explained-open-redirection-mdx":["/component---src-attacks-explained-open-redirection-mdx-ebae59b75a32f9f1dbd3.js"],"component---src-attacks-explained-path-traversal-mdx":["/component---src-attacks-explained-path-traversal-mdx-7479cad3d530d5464b71.js"],"component---src-attacks-explained-prototype-pollution-mdx":["/component---src-attacks-explained-prototype-pollution-mdx-b762e45cabbd302c4f66.js"],"component---src-attacks-explained-redos-mdx":["/component---src-attacks-explained-redos-mdx-f7e9fb0f7d0b1c0b3bad.js"],"component---src-attacks-explained-ssrf-mdx":["/component---src-attacks-explained-ssrf-mdx-de7fdd594d3296e684ac.js"],"component---src-attacks-explained-symlink-mdx":["/component---src-attacks-explained-symlink-mdx-7bcbdc1e2a42008b846c.js"],"component---src-attacks-explained-xml-bomb-mdx":["/component---src-attacks-explained-xml-bomb-mdx-cda0497cadb41084d315.js"],"component---src-attacks-explained-xss-mdx":["/component---src-attacks-explained-xss-mdx-c23d23846ff299040f0d.js"],"component---src-attacks-explained-zip-bomb-mdx":["/component---src-attacks-explained-zip-bomb-mdx-faa1f2cb35105db9e6b3.js"],"component---src-best-practices-cookies-mdx":["/component---src-best-practices-cookies-mdx-5bce9f8c2daa8b4251d5.js"],"component---src-best-practices-crypto-mdx":["/component---src-best-practices-crypto-mdx-29c8c1847fedb7b33f04.js"],"component---src-best-practices-databases-mdx":["/component---src-best-practices-databases-mdx-73bca768782f27923f89.js"],"component---src-best-practices-docker-mdx":["/component---src-best-practices-docker-mdx-8af0ec63db8996edc76a.js"],"component---src-best-practices-express-mdx":["/component---src-best-practices-express-mdx-efdebdaeb422dc428b57.js"],"component---src-best-practices-general-mdx":["/component---src-best-practices-general-mdx-6a5dae464b6d26e19eec.js"],"component---src-best-practices-intro-mdx":["/component---src-best-practices-intro-mdx-9ac6e9de0e3aba011404.js"],"component---src-best-practices-jwt-mdx":["/component---src-best-practices-jwt-mdx-0a9b550d0b860e689f30.js"],"component---src-best-practices-node-mdx":["/component---src-best-practices-node-mdx-0ff32941a36813758aa2.js"],"component---src-best-practices-npm-and-dependencies-mdx":["/component---src-best-practices-npm-and-dependencies-mdx-082ce62fda5ea43b1090.js"],"component---src-best-practices-session-and-tokens-mdx":["/component---src-best-practices-session-and-tokens-mdx-56dac4eda89c83576a70.js"],"component---src-best-practices-version-control-mdx":["/component---src-best-practices-version-control-mdx-d1020fa4a6b5eb37b84f.js"],"component---src-checklists-authorization-and-authentication-mdx":["/component---src-checklists-authorization-and-authentication-mdx-be2659f6e93d82c7d362.js"],"component---src-checklists-databases-mdx":["/component---src-checklists-databases-mdx-a8cc664f86ba3a95d182.js"],"component---src-checklists-docker-mdx":["/component---src-checklists-docker-mdx-737abe172436bae8c21b.js"],"component---src-checklists-express-mdx":["/component---src-checklists-express-mdx-3d2493b1a4c8af68dfef.js"],"component---src-checklists-intro-mdx":["/component---src-checklists-intro-mdx-2c27c6a2508c0442601b.js"],"component---src-checklists-nodejs-mdx":["/component---src-checklists-nodejs-mdx-35a6a93288f9e89aefa5.js"],"component---src-http-headers-content-security-policy-mdx":["/component---src-http-headers-content-security-policy-mdx-2fca2b960c6f8e595ae8.js"],"component---src-http-headers-cors-mdx":["/component---src-http-headers-cors-mdx-168719c4c8abbd905dd7.js"],"component---src-http-headers-crossdomain-mdx":["/component---src-http-headers-crossdomain-mdx-1a8208fcbf255d4a02e5.js"],"component---src-http-headers-dns-prefetch-control-mdx":["/component---src-http-headers-dns-prefetch-control-mdx-018855e0b79fb8e1cd58.js"],"component---src-http-headers-dont-sniff-mimetype-mdx":["/component---src-http-headers-dont-sniff-mimetype-mdx-ee26d5c26e4ff941062e.js"],"component---src-http-headers-etag-mdx":["/component---src-http-headers-etag-mdx-13d20bef7f985b5e6f59.js"],"component---src-http-headers-expect-ct-mdx":["/component---src-http-headers-expect-ct-mdx-f7c1f46db4c08c679586.js"],"component---src-http-headers-feature-policy-mdx":["/component---src-http-headers-feature-policy-mdx-f43da3c367be1250aa61.js"],"component---src-http-headers-frameguard-mdx":["/component---src-http-headers-frameguard-mdx-61631db5e9947add198b.js"],"component---src-http-headers-hsts-mdx":["/component---src-http-headers-hsts-mdx-3a96770b59bfb566a3fe.js"],"component---src-http-headers-ie-no-open-mdx":["/component---src-http-headers-ie-no-open-mdx-95812d56c777f56bdbce.js"],"component---src-http-headers-intro-mdx":["/component---src-http-headers-intro-mdx-078f131642dcd675d489.js"],"component---src-http-headers-powered-by-mdx":["/component---src-http-headers-powered-by-mdx-abe47475b24b7a0163ec.js"],"component---src-http-headers-referrer-policy-mdx":["/component---src-http-headers-referrer-policy-mdx-328cf4d17eaa07aabf76.js"],"component---src-http-headers-xss-filter-mdx":["/component---src-http-headers-xss-filter-mdx-d1d52d69172fe40301ba.js"],"component---src-owasp-top-10-a-10-insufficient-logging-and-monitoring-mdx":["/component---src-owasp-top-10-a-10-insufficient-logging-and-monitoring-mdx-d1d9261addeb92fe84ea.js"],"component---src-owasp-top-10-a-1-injection-mdx":["/component---src-owasp-top-10-a-1-injection-mdx-c6f4bea7b5023af4afc2.js"],"component---src-owasp-top-10-a-2-broken-authentication-mdx":["/component---src-owasp-top-10-a-2-broken-authentication-mdx-0344aad158b1617c2ddc.js"],"component---src-owasp-top-10-a-3-sensitive-data-exposure-mdx":["/component---src-owasp-top-10-a-3-sensitive-data-exposure-mdx-0cf982aead9eeca7f0c3.js"],"component---src-owasp-top-10-a-4-xml-external-entities-xxe-mdx":["/component---src-owasp-top-10-a-4-xml-external-entities-xxe-mdx-73d45648982ea6143f68.js"],"component---src-owasp-top-10-a-5-broken-access-control-mdx":["/component---src-owasp-top-10-a-5-broken-access-control-mdx-8aec85d381de19bf5065.js"],"component---src-owasp-top-10-a-6-security-misconfiguration-mdx":["/component---src-owasp-top-10-a-6-security-misconfiguration-mdx-edb7374ba72b8ce10740.js"],"component---src-owasp-top-10-a-7-cross-site-scripting-xss-mdx":["/component---src-owasp-top-10-a-7-cross-site-scripting-xss-mdx-f3ac093bb45e77765f06.js"],"component---src-owasp-top-10-a-8-insecure-deserialization-mdx":["/component---src-owasp-top-10-a-8-insecure-deserialization-mdx-aaa619bd02905d039f12.js"],"component---src-owasp-top-10-a-9-using-components-with-known-vulnerabilities-mdx":["/component---src-owasp-top-10-a-9-using-components-with-known-vulnerabilities-mdx-ea9cd6db6cae12cba8b5.js"],"component---src-owasp-top-10-intro-mdx":["/component---src-owasp-top-10-intro-mdx-ab8a403f6204a23cfcbf.js"],"component---src-proactive-controls-c-10-handle-all-errors-and-exceptions-mdx":["/component---src-proactive-controls-c-10-handle-all-errors-and-exceptions-mdx-27a1af254bfac821415a.js"],"component---src-proactive-controls-c-1-define-security-requirements-mdx":["/component---src-proactive-controls-c-1-define-security-requirements-mdx-7daf39a7f92aa9ec147a.js"],"component---src-proactive-controls-c-2-leverage-security-frameworks-and-libraries-mdx":["/component---src-proactive-controls-c-2-leverage-security-frameworks-and-libraries-mdx-c7617c33ffa4d8c51045.js"],"component---src-proactive-controls-c-3-secure-database-access-mdx":["/component---src-proactive-controls-c-3-secure-database-access-mdx-0696cc759d33bec30576.js"],"component---src-proactive-controls-c-4-encode-and-escape-data-mdx":["/component---src-proactive-controls-c-4-encode-and-escape-data-mdx-8bf40d1d8af61b155a76.js"],"component---src-proactive-controls-c-5-validate-all-inputs-mdx":["/component---src-proactive-controls-c-5-validate-all-inputs-mdx-0c16281f1f5c45f41782.js"],"component---src-proactive-controls-c-6-implement-digital-identity-mdx":["/component---src-proactive-controls-c-6-implement-digital-identity-mdx-a5e3dcdb282cf0becf93.js"],"component---src-proactive-controls-c-7-enforce-access-controls-mdx":["/component---src-proactive-controls-c-7-enforce-access-controls-mdx-9d3e0e563c9eb252ca6e.js"],"component---src-proactive-controls-c-8-protect-data-everywhere-mdx":["/component---src-proactive-controls-c-8-protect-data-everywhere-mdx-d8412a88407810f7075c.js"],"component---src-proactive-controls-c-9-implement-security-logging-and-monitoring-mdx":["/component---src-proactive-controls-c-9-implement-security-logging-and-monitoring-mdx-409003260fcf5eda1bfa.js"],"component---src-proactive-controls-intro-mdx":["/component---src-proactive-controls-intro-mdx-a3063e04ac39e7815f60.js"],"component---src-security-design-authentication-mdx":["/component---src-security-design-authentication-mdx-fe276fc81781feea3b8a.js"],"component---src-security-design-authorization-mdx":["/component---src-security-design-authorization-mdx-d954b069c56f749c2979.js"],"component---src-security-design-cryptography-mdx":["/component---src-security-design-cryptography-mdx-4e233f882daa8f6af035.js"],"component---src-security-design-data-validation-mdx":["/component---src-security-design-data-validation-mdx-ff2d7daa9fe20daee62f.js"],"component---src-security-design-external-components-mdx":["/component---src-security-design-external-components-mdx-4588879742cc8895f81a.js"],"component---src-security-design-future-changes-mdx":["/component---src-security-design-future-changes-mdx-5569dfcf5bd295949261.js"],"component---src-security-design-intro-mdx":["/component---src-security-design-intro-mdx-7da2fb1feda9de599055.js"],"component---src-security-design-sensitive-data-mdx":["/component---src-security-design-sensitive-data-mdx-5c5262b96dd03a67cd56.js"],"component---src-security-design-separation-mdx":["/component---src-security-design-separation-mdx-198acc25ee7087c421b6.js"],"component---src-security-design-trust-mdx":["/component---src-security-design-trust-mdx-7360bd429609772eb3be.js"],"component---src-security-design-users-mdx":["/component---src-security-design-users-mdx-3bc1656c776f87dd0146.js"],"component---src-pages-404-js":["/component---src-pages-404-js-8033ac2a47c70185616d.js"]};/*]]>*/</script><script src="/cybersecurity-handbook/component---src-owasp-top-10-a-1-injection-mdx-c6f4bea7b5023af4afc2.js" async=""></script><script src="/cybersecurity-handbook/5cd286446bb0219071d0c241a615bd26633322ed-c298033bff9b67cab161.js" async=""></script><script src="/cybersecurity-handbook/bac1b955-bf168f33e289fde76acd.js" async=""></script><script src="/cybersecurity-handbook/app-036a46d967ae9a7869d1.js" async=""></script><script src="/cybersecurity-handbook/styles-2d7da9d2d6649ee2da47.js" async=""></script><script src="/cybersecurity-handbook/framework-b48900d5a9d93cfeece4.js" async=""></script><script src="/cybersecurity-handbook/webpack-runtime-11484c19b06e24a038e4.js" async=""></script></body></html>