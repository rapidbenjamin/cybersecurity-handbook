---
title: A10 Insufficient logging and monitoring
sidebar_position: 11
---

# A10 Insufficient logging and monitoring

## Definition

Insufficient logging and monitoring, coupled with missing or ineffective integration with incident
response, allows attackers to further attack systems, maintain persistence, pivot to more systems,
and tamper, extract, or destroy data. Most breach studies show time to detect a breach is over
200 days, typically detected by external parties rather than internal processes or monitoring.

## Risk Factor Summary

- Score: 4.0
- Attack Vectors Exploitability: 2
- Security Weakness Prevalence: 3
- Security Weakness Detectability: 1
- Impact Technical: 2

## Context

<iframe
  width='100%'
  height='450'
  src='https://www.youtube.com/embed/IFF3tkUOF5E'
></iframe>

Exploitation of insufficient logging and
monitoring is the bedrock of nearly
every major incident.

Attackers rely on the lack of
monitoring and timely response to
achieve their goals without being
detected.

This issue is included in the Top 10 based on an
[industry survey](https://owasp.blogspot.com/2017/08/owasp-top-10-2017-project-update.html).

One strategy for determining if you have sufficient
monitoring is to examine the logs following
penetration testing. The testers’ actions should be
recorded sufficiently to understand what damages
they may have inflicted.
Most successful attacks start with
vulnerability probing. Allowing such
probes to continue can raise the
likelihood of successful exploit to
nearly 100%.

In 2016, identifying a breach took an
[average of 191 days](https://www-01.ibm.com/common/ssi/cgi-bin/ssialias?htmlfid=SEL03130WWEN&) – plenty of time
for damage to be inflicted.

## Is the Application Vulnerable?

Insufficient logging, detection, monitoring and active response
occurs any time:

- Auditable events, such as logins, failed logins, and high-value
  transactions are not logged.
- Warnings and errors generate no, inadequate, or unclear log
  messages.
- Logs of applications and APIs are not monitored for suspicious
  activity.
- Logs are only stored locally.
- Appropriate alerting thresholds and response escalation
  processes are not in place or effective.
- Penetration testing and scans by DAST tools (such as [OWASP
  ZAP](https://wiki.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project)) do not trigger alerts.
- The application is unable to detect, escalate, or alert for active
  attacks in real time or near real time.
  You are vulnerable to information leakage if you make logging
  and alerting events visible to a user or an attacker (see [A3:2017-
  Sensitive Information Exposure](/owasp-top-10/a3_sensitive_data_exposure)).

## Conceptual Attacks

### Scenario #1:

An open source project forum software run by a
small team was hacked using a flaw in its software. The
attackers managed to wipe out the internal source code
repository containing the next version, and all of the forum
contents. Although source could be recovered, the lack of
monitoring, logging or alerting led to a far worse breach. The
forum software project is no longer active as a result of this
issue.

### Scenario #2:

An attacker uses scans for users using a common
password. They can take over all accounts using this password.
For all other users, this scan leaves only one false login behind.
After some days, this may be repeated with a different password.

### Scenario #3:

A major US retailer reportedly had an internal malware analysis sandbox
analyzing attachments. The sandbox software had detected potentially
unwanted software, but no one responded to this detection.
The sandbox had been producing warnings for some time before the breach
was detected due to fraudulent card transactions by an external bank.

## How to Prevent

As per the risk of the data stored or processed by the application:

- Ensure all login, access control failures, and server-side input
  validation failures can be logged with sufficient user context to
  identify suspicious or malicious accounts, and held for sufficient
  time to allow delayed forensic analysis.
- Ensure that logs are generated in a format that can be easily
  consumed by a centralized log management solutions.
- Ensure high-value transactions have an audit trail with integrity
  controls to prevent tampering or deletion, such as append-only
  database tables or similar.
- Establish effective monitoring and alerting such that suspicious
  activities are detected and responded to in a timely fashion.
- Establish or adopt an incident response and recovery plan,
  such as [NIST 800-61 rev 2](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final) or later.
  There are commercial and open source application protection
  frameworks such as [OWASP AppSensor](https://wiki.owasp.org/index.php/OWASP_AppSensor_Project), web application
  firewalls such as ModSecurity with the [OWASP ModSecurity
  Core Rule Set](https://owasp.org/www-project-modsecurity-core-rule-set/), and log correlation software with custom
  dashboards and alerting.

## References

### OWASP

- [OWASP Cheat Sheet: Logging](https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html)

### CWEs

- [CWE-223: Omission of Security-relevant Information](https://cwe.mitre.org/data/definitions/223.html)
- [CWE-778: Insufficient Logging](https://cwe.mitre.org/data/definitions/223.html)
