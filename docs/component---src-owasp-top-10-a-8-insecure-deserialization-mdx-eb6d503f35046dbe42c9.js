(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{x6d0:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return o})),a.d(t,"default",(function(){return l}));a("5hJT"),a("W1QL"),a("K/PF"),a("t91x"),a("75LO"),a("PJhk"),a("mXGw");var i=a("/FXl"),n=a("TjRS");a("aD51");function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}var o={};void 0!==o&&o&&o===Object(o)&&Object.isExtensible(o)&&!o.hasOwnProperty("__filemeta")&&Object.defineProperty(o,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/owasp_top_10/a8_insecure_deserialization.mdx"}});var s={_frontmatter:o},c=n.a;function l(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,["components"]);return Object(i.b)(c,r({},s,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"a8-insecure-deserialization"},"A8 Insecure Deserialization"),Object(i.b)("h2",{id:"definition"},"Definition"),Object(i.b)("p",null,"Insecure deserialization often leads to remote code execution. Even if deserialization flaws do not\nresult in remote code execution, they can be used to perform attacks, including replay attacks,\ninjection attacks, and privilege escalation attacks. "),Object(i.b)("h2",{id:"risk-factor-summary"},"Risk Factor Summary"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Score: 5.0"),Object(i.b)("li",{parentName:"ul"},"Attack Vectors Exploitability: 1"),Object(i.b)("li",{parentName:"ul"},"Security Weakness Prevalence: 2"),Object(i.b)("li",{parentName:"ul"},"Security Weakness Detectability: 2"),Object(i.b)("li",{parentName:"ul"},"Impact Technical: 3")),Object(i.b)("h2",{id:"context"},"Context"),Object(i.b)("iframe",{width:"100%",height:"450",src:"https://www.youtube.com/embed/nkTBwbnfesQ"}),Object(i.b)("p",null,"Exploitation of deserialization is\nsomewhat difficult, as off the shelf\nexploits rarely work without changes\nor tweaks to the underlying exploit\ncode."),Object(i.b)("p",null,"This issue is included in the Top 10 based on an\n",Object(i.b)("a",r({parentName:"p"},{href:"https://owasp.blogspot.com/2017/08/owasp-top-10-2017-project-update.html"}),"industry survey")," and not on quantifiable data."),Object(i.b)("p",null,"Some tools can discover deserialization flaws, but\nhuman assistance is frequently needed to validate\nthe problem. It is expected that prevalence data for\ndeserialization flaws will increase as tooling is\ndeveloped to help identify and address it."),Object(i.b)("p",null,"The impact of deserialization flaws\ncannot be understated. These flaws\ncan lead to remote code execution\nattacks, one of the most serious\nattacks possible."),Object(i.b)("p",null,"The business impact depends on the\nprotection needs of the application\nand data."),Object(i.b)("h2",{id:"is-the-application-vulnerable"},"Is the Application Vulnerable?"),Object(i.b)("p",null,"Applications and APIs will be vulnerable if they deserialize hostile\nor tampered objects supplied by an attacker.\nThis can result in two primary types of attacks:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Object and data structure related attacks where the attacker\nmodifies application logic or achieves arbitrary remote code\nexecution if there are classes available to the application that\ncan change behavior during or after deserialization."),Object(i.b)("li",{parentName:"ul"},"Typical data tampering attacks, such as access-control-related\nattacks, where existing data structures are used but the content\nis changed.\nSerialization may be used in applications for:"),Object(i.b)("li",{parentName:"ul"},"Remote- and inter-process communication (RPC/IPC)"),Object(i.b)("li",{parentName:"ul"},"Wire protocols, web services, message brokers"),Object(i.b)("li",{parentName:"ul"},"Caching/Persistence"),Object(i.b)("li",{parentName:"ul"},"Databases, cache servers, file systems"),Object(i.b)("li",{parentName:"ul"},"HTTP cookies, HTML form parameters, API authentication\ntokens ")),Object(i.b)("h2",{id:"conceptual-attacks"},"Conceptual Attacks"),Object(i.b)("h3",{id:"scenario-1"},"Scenario #1:"),Object(i.b)("p",null,'A React application calls a set of Spring Boot\nmicroservices. Being functional programmers, they tried to\nensure that their code is immutable. The solution they came up\nwith is serializing user state and passing it back and forth with\neach request. An attacker notices the "R00" Java object\nsignature, and uses the Java Serial Killer tool to gain remote\ncode execution on the application server.'),Object(i.b)("h3",{id:"scenario-2"},"Scenario #2:"),Object(i.b)("p",null,'A PHP forum uses PHP object serialization to save\na "super" cookie, containing the user\'s user ID, role, password\nhash, and other state:'),Object(i.b)("pre",null,Object(i.b)("code",r({parentName:"pre"},{}),'a:4:{i:0;i:132;i:1;s:7:"Mallory";i:2;s:4:"user";\ni:3;s:32:"b6a8b3bea87fe0e05022f8f3c88bc960";}\n')),Object(i.b)("p",null,"An attacker changes the serialized object to give themselves\nadmin privileges:"),Object(i.b)("pre",null,Object(i.b)("code",r({parentName:"pre"},{}),'a:4:{i:0;i:1;i:1;s:5:"Alice";i:2;s:5:"admin";\ni:3;s:32:"b6a8b3bea87fe0e05022f8f3c88bc960";}\n')),Object(i.b)("h2",{id:"how-to-prevent"},"How to Prevent"),Object(i.b)("p",null,"The only safe architectural pattern is not to accept serialized\nobjects from untrusted sources or to use serialization mediums\nthat only permit primitive data types.\nIf that is not possible, consider one of more of the following:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Implementing integrity checks such as digital signatures on any\nserialized objects to prevent hostile object creation or data\ntampering."),Object(i.b)("li",{parentName:"ul"},"Enforcing strict type constraints during deserialization before\nobject creation as the code typically expects a definable set of\nclasses. Bypasses to this technique have been demonstrated,\nso reliance solely on this is not advisable."),Object(i.b)("li",{parentName:"ul"},"Isolating and running code that deserializes in low privilege\nenvironments when possible."),Object(i.b)("li",{parentName:"ul"},"Logging deserialization exceptions and failures, such as where\nthe incoming type is not the expected type, or the\ndeserialization throws exceptions."),Object(i.b)("li",{parentName:"ul"},"Restricting or monitoring incoming and outgoing network\nconnectivity from containers or servers that deserialize."),Object(i.b)("li",{parentName:"ul"},"Monitoring deserialization, alerting if a user deserializes\nconstantly.")),Object(i.b)("h2",{id:"hacking-playground"},"Hacking Playground"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",r({parentName:"li"},{href:"https://pwning.owasp-juice.shop/part2/insecure-deserialization.html"}),"ðŸ§ƒ Pwning OWASP Juice Shop | A8 Insecure Deserialization"))),Object(i.b)("h2",{id:"references"},"References"),Object(i.b)("h3",{id:"other"},"Other"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",r({parentName:"li"},{href:"https://blog.websecurify.com/2017/02/hacking-node-serialize.html"}),"websecurify |Â Hacking Node Serialize")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",r({parentName:"li"},{href:"https://www.youtube.com/watch?v=jIQWAz8UsLc"}),"Hack or Die [CTF] |Â  How to hack a server with Node.js Deserialization (Walkthrough)"))),Object(i.b)("h3",{id:"owasp"},"OWASP"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",r({parentName:"li"},{href:"https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html"}),"OWASP Cheat Sheet: Deserialization"))),Object(i.b)("h3",{id:"cwes"},"CWEs"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",r({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/502.html"}),"CWE-502: Deserialization of Untrusted Data"))))}void 0!==l&&l&&l===Object(l)&&Object.isExtensible(l)&&!l.hasOwnProperty("__filemeta")&&Object.defineProperty(l,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/owasp_top_10/a8_insecure_deserialization.mdx"}}),l.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-owasp-top-10-a-8-insecure-deserialization-mdx-eb6d503f35046dbe42c9.js.map