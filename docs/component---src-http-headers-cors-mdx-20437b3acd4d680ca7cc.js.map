{"version":3,"sources":["webpack:///../src/http_headers/cors.mdx","webpack:///../public/cors.svg","webpack:///../public/meme_05.png"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","alt","src","require","parentName","width","height","isMDXComponent","module","exports"],"mappings":"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","file":"component---src-http-headers-cors-mdx-20437b3acd4d680ca7cc.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/ulisesgascon/Desktop/WORKSPACE/GS-Projects/cybersecurity-handbook/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"http-header-cors\"\n    }}>{`HTTP Header: CORS`}</h1>\n    <p><img alt=\"CORS Meme\" src={require(\"../../public/meme_05.png\")} />{`\n`}<em parentName=\"p\">{`Image from `}<a parentName=\"em\" {...{\n          \"href\": \"https://medium.com/@joehonton/a-series-of-unhappy-events-in-corslandia-c7e7d1577e9e\"\n        }}>{`Joe Honton | A Series of Unhappy Events in Corslandia`}</a></em></p>\n    <h2 {...{\n      \"id\": \"what\"\n    }}>{`What?`}</h2>\n    <iframe width=\"100%\" height=\"450\" src=\"https://www.youtube.com/embed/0IMz8d9Cby4\">\n    </iframe>\n    <p><img alt=\"CORS Meme\" src={require(\"../../public/cors.svg\")} />{`\n`}<em parentName=\"p\">{`Image from `}<a parentName=\"em\" {...{\n          \"href\": \"https://portswigger.net/web-security/cors\"\n        }}>{`portswigger | Cross-origin resource sharing (CORS)`}</a></em></p>\n    <blockquote>\n      <p parentName=\"blockquote\">{`Cross-origin resource sharing (CORS) is a browser mechanism which enables controlled access to resources located outside of a given domain. It extends and adds flexibility to `}<a parentName=\"p\" {...{\n          \"href\": \"https://portswigger.net/web-security/cors/same-origin-policy\"\n        }}>{`the same-origin policy (SOP)`}</a>{`. However, it also provides potential for cross-domain based attacks, if a website's CORS policy is poorly configured and implemented. CORS is not a protection against cross-origin attacks such as cross-site request forgery (CSRF).\n`}<em parentName=\"p\">{`by `}<a parentName=\"em\" {...{\n            \"href\": \"https://portswigger.net/web-security/cors\"\n          }}>{`portswigger | Cross-origin resource sharing (CORS)`}</a></em>{` `}</p>\n    </blockquote>\n    <h2 {...{\n      \"id\": \"the-header\"\n    }}>{`The header`}</h2>\n    <p>{`In order to manage CORS we need to use several headers that have a common pattern `}<inlineCode parentName=\"p\">{`Access-Control-*`}</inlineCode></p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`Access-Control-Allow-Origin`}</inlineCode>{`: indicates whether the response can be shared with requesting code from the given origin. Valid values (single url, `}<inlineCode parentName=\"li\">{`*`}</inlineCode>{` or `}<inlineCode parentName=\"li\">{`null`}</inlineCode>{`). `}<a parentName=\"li\" {...{\n          \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin\"\n        }}>{`See Documentation`}</a></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`Access-Control-Allow-Credentials`}</inlineCode>{`: tells browsers whether to expose the response to frontend JavaScript code when the request's credentials mode (`}<inlineCode parentName=\"li\">{`Request.credentials`}</inlineCode>{`) is include. `}<a parentName=\"li\" {...{\n          \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials\"\n        }}>{`See Documentation`}</a></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`Access-Control-Allow-Methods`}</inlineCode>{`: response header specifies the method or methods allowed when accessing the resource in response to a preflight request. `}<a parentName=\"li\" {...{\n          \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Methods\"\n        }}>{`See Documentation`}</a></li>\n    </ul>\n    <p>{`There are other headers like `}<inlineCode parentName=\"p\">{`Access-Control-Allow-Headers`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`Access-Control-Expose-Headers`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`Access-Control-Max-Age`}</inlineCode>{`... used for `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.mozilla.org/en-US/docs/Glossary/preflight_request\"\n      }}>{`CORS preflight requests`}</a></p>\n    <h2 {...{\n      \"id\": \"the-code\"\n    }}>{`The code`}</h2>\n    <p>{`There is an official Middleware made by the Express team called `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.npmjs.com/package/cors\"\n      }}>{`CORS`}</a></p>\n    <h3 {...{\n      \"id\": \"simple-usage\"\n    }}>{`Simple Usage`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const express = require('express')\nconst cors = require('cors')\nconst app = express()\n \napp.use(cors())\n \napp.get('/products/:id', (req, res, next) => {\n  res.json({msg: 'This is CORS-enabled for all origins!'})\n})\n \napp.listen(8080, () => {\n  console.log('CORS-enabled web server listening on port 80')\n})\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"configuring-cors-w-dynamic-origin\"\n    }}>{`Configuring CORS w/ Dynamic Origin`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const express = require('express')\nconst cors = require('cors')\nconst app = express()\n \nconst whitelist = ['http://example1.com', 'http://example2.com']\n\nconst corsOptions = {\n  origin: (origin, cb) => {\n    whitelist.includes(origin) ? cb(null, true) : cb(new Error('Not allowed by CORS'))\n  }\n}\n\napp.get('/products/:id', cors(corsOptions), (req, res, next) => {\n  res.json({msg: 'This is CORS-enabled for a whitelisted domain.'})\n})\n \napp.listen(8080, () => {\n  console.log('CORS-enabled web server listening on port 80')\n})\n`}</code></pre>\n    <p>{`Don't forget to check `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.npmjs.com/package/cors#configuration-options\"\n      }}>{`the configuration features`}</a></p>\n    <h2 {...{\n      \"id\": \"attacks\"\n    }}>{`Attacks`}</h2>\n    <p>{`Most of the CORS attacks are based on generating a response header that allow the attackers to add their malicious domain in the `}<inlineCode parentName=\"p\">{`Access-Control-Allow-Origin`}</inlineCode>{`.`}</p>\n    <p>{`In most of the cases this flaws are generated by misconfiguration.`}</p>\n    <h2 {...{\n      \"id\": \"solution\"\n    }}>{`Solution`}</h2>\n    <ul>\n      <li parentName=\"ul\">{`Never use the Request `}<inlineCode parentName=\"li\">{`origin`}</inlineCode>{` value as the response `}<inlineCode parentName=\"li\">{`Access-Control-Allow-Origin`}</inlineCode>{` value.`}</li>\n      <li parentName=\"ul\">{`Avoid wildcard validation like `}<inlineCode parentName=\"li\">{`*-website.com`}</inlineCode>{`, as the malicious attacks can match the criteria ( `}<inlineCode parentName=\"li\">{`good-website.com`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`evil-website.com`}</inlineCode>{`...).`}</li>\n      <li parentName=\"ul\">{`Avoid to whitelist `}<inlineCode parentName=\"li\">{`null`}</inlineCode>{` as valid Origin value in the request header.`}</li>\n      <li parentName=\"ul\">{`Avoid wildcards in internal networks`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"refs\"\n    }}>{`Refs`}</h3>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://medium.com/@joehonton/a-series-of-unhappy-events-in-corslandia-c7e7d1577e9e\"\n        }}>{`Medium | A Series of Unhappy Events in Corslandia`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://portswigger.net/web-security/cors\"\n        }}>{`portswigger | Cross-origin resource sharing (CORS)`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://developer.mozilla.org/en-US/docs/Glossary/preflight_request\"\n        }}>{`MDN | CORS preflight requests`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\"\n        }}>{`MDN | Cross-Origin Resource Sharing (CORS)`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://www.html5rocks.com/en/tutorials/cors/\"\n        }}>{`html5rocks | Using CORS`}</a></li>\n    </ul>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","module.exports = __webpack_public_path__ + \"static/cors-728e32aad548c0a7b0874cdfda9cd1ea.svg\";","module.exports = __webpack_public_path__ + \"static/meme_05-d963961847f937d8c033e1e598177c73.png\";"],"sourceRoot":""}