(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{OOWh:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return n})),a.d(t,"default",(function(){return l}));a("5hJT"),a("W1QL"),a("K/PF"),a("t91x"),a("75LO"),a("PJhk"),a("mXGw");var r=a("/FXl"),i=a("TjRS");a("aD51");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var n={};void 0!==n&&n&&n===Object(n)&&Object.isExtensible(n)&&!n.hasOwnProperty("__filemeta")&&Object.defineProperty(n,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/http_headers/hsts.mdx"}});var o={_frontmatter:n},c=i.a;function l(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,["components"]);return Object(r.b)(c,s({},o,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"http-header-strict-transport-security-hsts"},"HTTP Header: Strict Transport Security (HSTS)"),Object(r.b)("h2",{id:"the-attack"},"The attack"),Object(r.b)("p",null,"As we are not forcing the HTTPS traffic to be keep using HTTPS. The users can use the HTTP (vanilla) protocol to access our site."),Object(r.b)("p",null,"As a result of this protocol downgrade we will expose sensitive information (ajax payloads, cookies, tokens...) in plain text."),Object(r.b)("p",null,"Our users are vulnerable to person-in-the-middle attacks as nothing sent is encrypted."),Object(r.b)("iframe",{width:"100%",height:"450",src:"https://www.youtube.com/embed/zEV3HOuM_Vw"}),Object(r.b)("h2",{id:"the-header"},"The header"),Object(r.b)("p",null,"The Strict-Transport-Security HTTP header tells browsers to stick with HTTPS and never visit the insecure HTTP version. Once a browser sees this header, it will only visit the site over HTTPS for the next 60 days:"),Object(r.b)("pre",null,Object(r.b)("code",s({parentName:"pre"},{}),"Strict-Transport-Security: max-age=5184000\n")),Object(r.b)("h3",{id:"limitations"},"Limitations"),Object(r.b)("p",null,"The initial request remains unprotected from active attacks if it uses an insecure protocol such as plain HTTP or if the URI for the initial request was obtained over an insecure channel.\nThe same applies to the first request after the activity period specified in the advertised HSTS Policy ",Object(r.b)("inlineCode",{parentName:"p"},"max-age"),' (sites should set a period of several days or months depending on user activity and behavior).\nGoogle Chrome, Mozilla Firefox and Internet Explorer/Microsoft Edge address this limitation by implementing a "HSTS preloaded list", which is a list that contains known sites supporting HSTS.'),Object(r.b)("h3",{id:"privacy-issues"},"Privacy issues"),Object(r.b)("p",null,"HSTS can be used to near-indelibly tag visiting browsers with recoverable identifying data (",Object(r.b)("a",s({parentName:"p"},{href:"https://en.wikipedia.org/wiki/HTTP_cookie#Supercookie"}),"supercookies"),') which can persist in and out of browser "incognito" privacy modes. ',Object(r.b)("a",s({parentName:"p"},{href:"https://nakedsecurity.sophos.com/2015/02/02/anatomy-of-a-browser-dilemma-how-hsts-supercookies-make-you-choose-between-privacy-or-security/"}),"See")),Object(r.b)("h2",{id:"the-code"},"The code"),Object(r.b)("p",null,"You can use this module as part of Helmet:"),Object(r.b)("pre",null,Object(r.b)("code",s({parentName:"pre"},{className:"language-js"}),"const helmet = require('helmet')\n\n// Sets \"Strict-Transport-Security: max-age=5184000; includeSubDomains\".\nconst sixtyDaysInSeconds = 5184000\napp.use(helmet.hsts({\n  maxAge: sixtyDaysInSeconds\n}))\n")),Object(r.b)("h3",{id:"disable-for-subdomains"},"Disable for subdomains"),Object(r.b)("pre",null,Object(r.b)("code",s({parentName:"pre"},{className:"language-js"}),'// Sets "Strict-Transport-Security: max-age=5184000".\napp.use(helmet.hsts({\n  maxAge: sixtyDaysInSeconds,\n  includeSubDomains: false\n}))\n')),Object(r.b)("h3",{id:"preloading-hsts-in-chrome"},"Preloading HSTS in Chrome"),Object(r.b)("p",null,"Some browsers let you submit your site’s HSTS to be baked into the browser. You can add preload to the header with the following code. You can check your eligibility and submit your site at ",Object(r.b)("a",s({parentName:"p"},{href:"https://hstspreload.org/"}),"hstspreload.org"),"."),Object(r.b)("pre",null,Object(r.b)("code",s({parentName:"pre"},{className:"language-js"}),"app.use(helmet.hsts({\n  // Must be at least 1 year to be approved\n  maxAge: 31536000,\n\n  // Must be enabled to be approved\n  includeSubDomains: true,\n  preload: true\n}))\n")),Object(r.b)("h3",{id:"refs"},"Refs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",s({parentName:"li"},{href:"https://helmetjs.github.io/docs/hsts"}),"Helmet | HSTS")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",s({parentName:"li"},{href:"https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security"}),"Wikipedia | HTTP Strict Transport Security")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",s({parentName:"li"},{href:"https://nakedsecurity.sophos.com/2015/02/02/anatomy-of-a-browser-dilemma-how-hsts-supercookies-make-you-choose-between-privacy-or-security/"}),"SOPHOS | Anatomy of a browser dilemma – how HSTS ‘supercookies’ make you choose between privacy or security"))))}void 0!==l&&l&&l===Object(l)&&Object.isExtensible(l)&&!l.hasOwnProperty("__filemeta")&&Object.defineProperty(l,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/http_headers/hsts.mdx"}}),l.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-http-headers-hsts-mdx-09973962db87fe6f7631.js.map